WBStartup:FindScreen0


#LED_Dummy    = #TAG_USER+$04000000
#LED_Pairs    = #LED_Dummy+1
#LED_Values   = #LED_Dummy+2
#LED_Colon    = #LED_Dummy+3
#LED_Negative = #LED_Dummy+4
#LED_Signed   = #LED_Dummy+5

*lib.Library = OpenLibrary_("libs:images/led.image",0)
If *lib=0
Request "Fehler","Konnte LED.image nicht ffnen","Ok"
End
EndIf

*sc._Screen=LockPubScreen_("Workbench")
*dr.DrawInfo=GetScreenDrawInfo_(*sc)

Dim fenster.TagItem(11)

fenster(0)\ti_Tag = #WA_Top,(*sc\Height/2)-85
fenster(1)\ti_Tag = #WA_Left,(*sc\Width/2)-60
fenster(2)\ti_Tag = #WA_Width,170
fenster(3)\ti_Tag = #WA_InnerHeight,120
fenster(4)\ti_Tag = #WA_SmartRefresh,1
fenster(5)\ti_Tag = #WA_Activate,1
fenster(6)\ti_Tag = #WA_Title,0;?fenstertext
fenster(7)\ti_Tag = #WA_CustomScreen,*sc
fenster(8)\ti_Tag = #WA_CloseGadget,1
fenster(9)\ti_Tag = #WA_IDCMP,#IDCMP_CLOSEWINDOW|#IDCMP_REFRESHWINDOW|#IDCMP_INTUITICKS
fenster(10)\ti_Tag= #TAG_END,0

*win._Window=OpenWindowTagList_(0,&fenster(0))
q.l=SetFont_(*win\RPort,*mylcd25Font)

Dim pentags.TagItem(3)
 pentags(0)\ti_Tag=#OBP_Precision,#PRECISION_IMAGE
 pentags(1)\ti_Tag=#OBP_FailIfBad,1
 pentags(2)\ti_Tag=#TAG_END,0

*vport._ViewPort = ViewPortAddress_(*win)

fpen = ObtainBestPenA_(*vport\ColorMap,0,$F9999999,0,&pentags(0))
bpen = ObtainBestPenA_(*vport\ColorMap,0,0,0,&pentags(0))
SetBPen_ *win\RPort,bpen
SetRast_ *win\RPort,bpen

Dim a.w(3)
NEWTYPE .xy:x.w:y.w:End NEWTYPE ;coordinates for hands
Dim h.xy(59)
For i=0 To 59
  h(i)\x=68*Sin(i*Pi/30),-32*Cos(i*Pi/30)
Next

hr=5*(Hours MOD 12)
a(0)=Val(Str$(Hours))
a(1)=Val(Str$(Mins))
a(2)=Val(Str$(Secs))

Dim knopf.TagItem(8)
 knopf(0)\ti_Tag=#IA_FGPen,fpen
 knopf(1)\ti_Tag=#IA_BGPen,bpen
 knopf(2)\ti_Tag=#IA_Width,120
 knopf(3)\ti_Tag=#IA_Height,50
 knopf(4)\ti_Tag=#LED_Pairs,3
 knopf(5)\ti_Tag=#LED_Values,&a(0)
 knopf(6)\ti_Tag=#LED_Colon,1
 knopf(7)\ti_Tag=#TAG_END,0

*img.Image = NewObjectA_(0,"led.image",&knopf(0))

DrawImage_ *win\RPort,*img,(*win\Width/2)-55,(*win\Height/2)-25
RefreshWindowFrame_ *win

loop = 1
 While loop
  Delay_ 50
   *imsg.IntuiMessage = GT_GetIMsg_(*win\UserPort)
    class.l = *imsg\Class
     Select class
      Case #IDCMP_CLOSEWINDOW
       loop = 0
     End Select
;hr=5*(Hours MOD 12)
a(0)=Val(Str$(Hours))
a(1)=Val(Str$(Mins))
a(2)=Val(Str$(Secs))

 knopf(0)\ti_Tag=#LED_Values,&a(0)
 knopf(2)\ti_Tag=#TAG_END,0

SetAttrsA_ *img,&knopf(0)
DrawImage_ *win\RPort,*img,(*win\Width/2)-55,(*win\Height/2)-25
 Wend

CloseWindow_ *win:FreeScreenDrawInfo_ *sc,*dr:UnlockPubScreen_ "Workbench",*sc:CloseLibrary_ *lib
End

