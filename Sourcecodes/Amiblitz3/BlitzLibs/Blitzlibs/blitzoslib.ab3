; XTRA
; Embedded .xtra Header
; 
; General Info
; -------------------------------------------------------
; ExePath         = "Blitz3:BlitzLibs/Decompiled/baselibs"
; ExeFile         = "blitzoslib_new.obj"
; CreateIcon      = 0
; Residents       = "libjsrs.res,libnums.res,libmacs.res"
; 
; Compiler
; -------------------------------------------------------
; StringBuffer    = 64000
; MakeSmallest    = 1
; FuncOptimize    = 1
; Version         = 3.9.11
; NumberOfBuilds  = 3277
; 
; Debugger
; -------------------------------------------------------
; CliArgs         = ""
; StackSize       = 8192
; RuntimeDebug    = 0
; DebugInfo       = 0
; CreateDbgFile   = 0
; OverflowCheck   = 0
; AssemblerCheck  = 0
; InterruptCheck  = 1
; AutoRun         = 1
; 
; Editor
; -------------------------------------------------------
; CursorLine      = 75
; CursorColumn    = 1
; LabelSearch     = ""debug"
; LabelRemark     = 0
; LabelAll        = 1
; LabelCase       = 0
; LabelPosition   = 0
; 
; Blitz Objects
; -------------------------------------------------------
; Max File        = 25
; Max GadgetList  = 5
; Max Shape       = 100
; Max Bank        = 5
; Max MenuList    = 5
; Max GTList      = 25
; Max Palette     = 4
; Max BitMap      = 1
; Max Screen      = 5
; Max IntuiFont   = 5
; Max BlitzFont   = 4
; Max Window      = 25
; Max IconInfo    = 1
; Max MUIObject   = 50
; Max AsyncReq    = 4
; Max Req-Lib     = 5
; Max GTMenuList  = 30
; Max Console     = 5
; Max TCPSock     = 5
; Max Tape        = 5
; Max TagList     = 5
; Max Database    = 16
; Max Sound       = 10
; Max MedModule   = 8
; Max Buffer      = 10
; Max Queue       = 10
; Max Sprite      = 20
; Max Module      = 5
; Max Slice       = 10
; Max Page        = 4
; Max CopList     = 10
; Max PTModule    = 5
; Max Anim        = 10
; Max NChunky     = 50
; Max Chunky      = 20
; Max Stencil     = 5
; Max XBSound     = 10
; /XTRA
; IRA V2.10 (04.12.23) (c)1993-1995 Tim Ruehsen
; (c)2009-2015 Frank Wille, (c)2014-2019 Nicolas Bastien

HARDBASE EQU $DFF000
DMACONR  EQU $DFF002

!libheader{#blitzoslib,0,0,0,0}
!dumtoke{"Page","",_toke}

!astatement
!args{#word,#word,#word}
!libs{#bitmaplib,#ia2|#pd1,#blitzoslib,#ia3,#blitzoslib,#ld6|#pd4}
!subs{_initpage,0,0}
!name{"InitPage","Page#,BitMap#,NumBoxes"}

!astatement
!args{#word}
!libs{#blitzoslib,#ia3}
!subs{_freepage,0,0}
!name{"FreePage","Page#"}

!astatement
!args{#word,#word,#word,#word,#word,#word,#word}
!libs{#blitzoslib,#ia3}
!subs{_addbox,0,0}
!args{#word,#word,#word,#word,#word,#word,#word,#string}
!libs{#blitzoslib,#ia3}
!subs{_addboxWithText,0,0}
!args{#word,#word,#word,#word,#word,#word,#word,#word,#word}
!libs{#blitzoslib,#ia3}
!subs{_addboxWithShapes,0,0}
!name{"AddBox","Page#,Box#,x,y,w,h,type[,text$]|[,shape,shape]"}

!astatement
!args
!libs{#blitzoslib,#ua3}
!subs{_redrawpage,1,0}
!name{"RedrawPage",""}
 
!astatement
!args{#word}
!libs{#blitzoslib,#ua3}
!subs{_redrawbox,1,0}
!name{"RedrawBox","Box#"}
 
!astatement
!args{#word}
!libs{#blitzoslib,#ua3}
!subs{_selectbox,1,0}
!args{#word,#word}
!libs{#blitzoslib,#ua3}
!subs{_selectbox1,1,0}
!args{#word,#word,#word}
!libs{#blitzoslib,#ua3}
!subs{_selectbox2,1,0}
!name{"SelectBox","[Box#]|[x+,y+][0,x,y] ;deselects previously selected"}

!astatement
!args
!libs{#blitzoslib,#ua3}
!subs{_deselectbox,1,0}
!name{"DeSelectBox",""}
 
!astatement
!args
!libs{#blitzoslib,#ua3}
!subs{_activateselectedbox,1,0}
!name{"ActivateSelectedBox",""} 

!astatement
!args{#word,#word}
!libs{#blitzoslib,#ua3}
!subs{_setbox1,0,0}
!args{#word,#quick,#quick}
!libs{#blitzoslib,#ua3}
!subs{_setbox,1,0}
!name{"SetBox","Box#[,Value]|[xprop,yprop]"} 
 
!afunction{#word}
!args{#word}
!libs{#blitzoslib,#ua3}
!subs{_boxvalue,1,0}
!args{#word,#word}
!libs{#blitzoslib,#ia3}
!subs{_boxvalue1,1,0}
!name{"BoxValue","(Box#)|(Page#,Box#)"}  
 
!astatement
!args{#word,#string}
!libs{#blitzoslib,#ua3}
!subs{_setboxstring,0,0}
!name{"SetBoxString","Box#,String$"} 
 
!afunction{#string}
!args{#word}
!libs{#blitzoslib,#ua1}
!subs{_boxstring,1,0}
!args{#word,#word}
!libs{#blitzoslib,#ia1}
!subs{_boxstring1,1,0}
!name{"BoxString","(Box#)|(Page#,Box#)"} 

!astatement
!args{#word,#word,#word,#word}
!libs{#blitzoslib,#ua3,#bitmaplib,#ia2|#pd1}
!subs{_boxshow,1,0}
!args{#word,#word,#word}
!libs{#blitzoslib,#ua3}
!subs{_boxshow1,1,0}
!name{"BoxShow","Box#[,Bitmap#,x,y]|[dx,dy]"} 

!afunction{#word}
!args
!libs{#blitzoslib,#ua3}
!subs{_boxselected,1,0}
!name{"BoxSelected",""} 

!astatement
!args{#word,#string}
!libs{#blitzoslib,#ua3}
!subs{_boxprint,1,0}
!args{#word,#word,#word}
!libs{#blitzoslib,#ua3,#banklib,#ia2|#pd1}
!subs{_boxprint1,1,0}
!name{"BoxPrint","Box#[,String$]|[Bank#,Line]"} 
 
!astatement
!args{#word,#word}
!libs{#blitzoslib,#ua3}
!subs{_setboxcolor,1,0}
!name{"SetBoxColor","Box#,color"} 
 
!afunction{#word}
!args
!libs{#blitzoslib,#ua3}
!subs{_blitzevent,1,0}
!name{"BlitzEvent",";handles user input and returns event"} 
 
!astatement
!args{#word,#string}
!libs{#blitzoslib,#ua3}
!subs{_setboxtitle,1,0}
!name{"SetBoxTitle","Box#,String$"} 
 
!astatement
!args{#word}
!libs{#blitzoslib,#ua3}
!subs{_disablebox,1,0}
!name{"DisableBox","Box#"} 

!astatement
!args{#word}
!libs{#blitzoslib,#ua3}
!subs{_enablebox,1,0}
!name{"EnableBox","Box#"}

!afunction{#word}
!args
!libs
!subs{_mouseenabled,1,0}
!name{"MouseEnabled",""}   
 
!astatement
!args{#word,#word,#word,#word,#word}
!libs{#blitzoslib,#ia3}
!subs{_setpagepens,0,0}
!name{"SetPagePens","Page#,c0,c1,c2,c3 (defaults: 3,1,2,3)"}    
 
!afunction{#quick}
!args{#word}
!libs{#blitzoslib,#ua3}
!subs{_boxpropx,1,0}
!name{"BoxPropX","Box#"} 

!afunction{#quick}
!args{#word}
!libs{#blitzoslib,#ua3}
!subs{_boxpropy,1,0}
!name{"BoxPropY","Box#"} 
 
!astatement
!args{#word,#word,#word}
!libs{#blitzoslib,#ia3}
!subs{_changebox,0,0}
!name{"ChangeBox","Page#,Box#,Value"}

!astatement
!args{#word}
!libs{#blitzoslib,#ua3}
!subs{_togglebox,1,0}
!name{"ToggleBox","Box#"}

!afunction{#word}
!args
!libs{#blitzoslib,#ua3}
!subs{_spotbox,1,0}
!name{"SpotBox","; returns box that mouse is over"}

_load: !nullsub{0,0,0}
_save: !nullsub{0,0,0}
_use:  !nullsub{0,0,0}
_free: !nullsub{0,0,0}

!libfin{_toke,_load,_save,_use,_free,4,5}

; ===============================================================================
_boxpropx:
  TST.l (A3)   ;0850: 4a93
  BEQ.w error_uninitpage  ;0852: 67001496
  ;DC.w $b06b   ;0856
  ;DC.w $000c   ;0858
  CMP.w   $c(A3),D0
  BCC.w error_illegalboxnumber  ;085a: 640014aa
  ASL.w #5,D0   ;085e: eb40
  MOVEA.l 4(A3),A0  ;0860: 206b0004
  ADDA.w D0,A0   ;0864: d0c0
  MOVE.w 12(A0),D0  ;0866: 3028000c
  EXT.l D0   ;086a: 48c0
  ASL.l #1,D0   ;086c: e380
RTS    ;086e: 4e75

_boxpropy:
  TST.l (A3)   ;0870: 4a93
  BEQ.w error_uninitpage  ;0872: 67001476
  ;DC.w $b06b   ;0876
  ;DC.w $000c   ;0878
  CMP.w   $c(A3),D0
  BCC.w error_illegalboxnumber  ;087a: 6400148a
  ASL.w #5,D0   ;087e: eb40
  MOVEA.l 4(A3),A0  ;0880: 206b0004
  ADDA.w D0,A0   ;0884: d0c0
  MOVE.w 14(A0),D0  ;0886: 3028000e
  EXT.l D0   ;088a: 48c0
  ASL.l #1,D0   ;088c: e380
RTS    ;088e: 4e75

_freepage:
  MOVE.l 0(A3),D0  ;0890: 202b0000
  BEQ.w LAB_0009  ;0894: 67000016
    MOVEA.l 4(A3),A1  ;0898: 226b0004
    ALibJsr #globalfree
    MOVEQ #0,D0   ;08a2:  7000
    MOVE.l D0,0(A3)  ;08a4: 27400000
    MOVE.w D0,12(A3)  ;08a8: 3740000c
  LAB_0009:
RTS    ;08ac: 4e75

; Struct Page (in A3)
;   memsize.L     0
;   memptr.L      4
;   bitmapptr.l   8
;   ??.W         12
;   color0.w     14
;   color1.w     16
;   color2.w     18
;   color3.w     20
;
;libs{#bitmaplib,#ia2|#pd1,#blitzoslib,#ia3,#blitzoslib,#ld6|#pd4}
_initpage: ; D0: Page#, D1:Bitmap#, D2: number of boxes
  MOVE.l A3,0(A5,D6.w)  ;08ae: 2b8b6000
  TST.w (A2)   ;08b2: 4a52
  BEQ.w error_uninitbitmap  ;08b4: 670014f2

  BSR.w _freepage  ;08b8: 6100ffd6

  MOVE.w D2,12(A3)  ;08bc: 3742000c
  EXT.l D2   ;08c0: 48c2
  ASL.l #5,D2   ;08c2: eb82
  MOVE.l D2,0(A3)  ;08c4: 27420000
  MOVE.l #$00010001,D1  ;08c8: 223c00010001
  MOVE.l D2,D0   ;08ce: 2002
  ALibJsr #globalalloc  
  MOVE.l D0,4(A3)  ;08d6: 27400004
  
  MOVE.w #$0001,14(A3)  ;08da: 377c0001000e
  MOVE.w #$0003,16(A3)  ;08e0: 377c00030010
  MOVE.w #$0002,18(A3)  ;08e6: 377c00020012
  MOVE.w #$0001,20(A3)  ;08ec: 377c00010014
  MOVE.l A2,8(A3)  ;08f2: 274a0008
RTS    ;08f6: 4e75

_setpagepens:
  MOVEM.w D1-D4,14(A3)  ;08f8: 48ab001e000e
RTS    ;08fe: 4e75

_togglebox:
  TST.l (A3)   ;0900: 4a93
  BEQ.w error_uninitpage  ;0902: 670013e6
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;090a: 640013fa
  
  ASL.w #5,D0   ;090e: eb40
  MOVEA.l 4(A3),A0  ;0910: 206b0004
  ADDA.w D0,A0   ;0914: d0c0
  NOT.w 10(A0)   ;0916: 4668000a
RTS    ;091a: 4e75

_enablebox:
  TST.l (A3)   ;091c: 4a93
  BEQ.w error_uninitpage  ;091e: 670013ca
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;0926: 640013de
  
  ASL.w #5,D0   ;092a: eb40
  MOVEA.l 4(A3),A0  ;092c: 206b0004
  ADDA.w D0,A0   ;0930: d0c0
  TST.w 8(A0)   ;0932: 4a680008
  BPL.w LAB_000E  ;0936: 6a000006
    NEG.w 8(A0)   ;093a: 44680008
  LAB_000E:
RTS    ;093e: 4e75

_disablebox:
  TST.l (A3)   ;0940: 4a93
  BEQ.w error_uninitpage  ;0942: 670013a6
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;094a: 640013ba
  
  ASL.w #5,D0   ;094e: eb40
  MOVEA.l 4(A3),A0  ;0950: 206b0004
  ADDA.w D0,A0   ;0954: d0c0
  TST.w 8(A0)   ;0956: 4a680008
  BLE.w LAB_0010  ;095a: 6f000006
    NEG.w 8(A0)   ;095e: 44680008
  LAB_0010:
RTS    ;0962: 4e75

_setboxtitle:
  TST.l (A3)   ;0964: 4a93
  BEQ.w error_uninitpage  ;0966: 67001382
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;096e: 64001396
  
  ASL.w #5,D0   ;0972: eb40
  MOVEA.l 4(A3),A0  ;0974: 206b0004
  ADDA.w D0,A0   ;0978: d0c0
  MOVEA.l D1,A1   ;097a: 2241
  MOVE.l -(A2),D0  ;097c: 2022
  CMPI.w #$0002,8(A0)  ;097e: 0c6800020008
  BEQ.w LAB_001B  ;0984: 670000ae
  
  MOVEM.l D0/A1,-(A7)  ;0988: 48e78040
  MOVEM.l 20(A0),D0/A1  ;098c: 4ce802010014
  TST.l D0   ;0992: 4a80
  BEQ.w LAB_0012  ;0994: 67000008
    ALibJsr #globalfree
  LAB_0012:
  MOVEM.l (A7)+,D0/A1  ;099e: 4cdf0201
  BRA.w LAB_0015  ;09a2: 60000038

;Page#,Box#,x,y,w,h,type[,shape,shape]
_addboxWithShapes:
  BSR.w _addbox  ;09a6: 610000aa
  MOVEM.w -4(A2),D0-D1  ;09aa: 4caa0003fffc
  EXG D0,D1   ;09b0: c141
  SUB.w D0,D1   ;09b2: 9240
  ADDQ.w #1,D1   ;09b4: 5241
  MOVE.w D1,14(A0)  ;09b6: 3141000e
  MOVE.w D0,18(A0)  ;09ba: 31400012
  MOVE.w #$ffff,16(A0)  ;09be: 317cffff0010
RTS    ;09c4: 4e75

;Page#,Box#,x,y,w,h,type[,text$]
_addboxWithText:
  BSR.w _addbox  ;09c6: 6100008a
  MOVEM.l -8(A2),D0/A1  ;09ca: 4cea0201fff8
  EXG  D0,A1
  CMPI.w #$0002,8(A0)  ;09d2: 0c6800020008
  BEQ.w LAB_001B  ;09d8: 6700005a

  LAB_0015:
  ADDQ.w #1,D0   ;09dc: 5240
  MOVE.l D0,20(A0)  ;09de: 21400014
  MOVEQ #0,D1   ;09e2: 7200
  ALibJsr #globalalloc
  MOVE.l D0,24(A0)  ;09ea: 21400018
  MOVEA.l D0,A2   ;09ee: 2440
  MOVEQ #1,D1   ;09f0: 7201
  CMPI.b #$7c,(A1)  ;09f2: 0c11007c
  BNE.w LAB_0017  ;09f6: 6600000e
    LAB_0016:
      MOVE.b (A1)+,D0  ;09fa: 1019
      BEQ.w LAB_0019  ;09fc: 67000020
      MOVE.b D0,(A2)+  ;0a00: 14c0
    BRA.w LAB_0016  ;0a02: 6000fff6
  LAB_0017:
    MOVE.b (A1)+,D0  ;0a06: 1019
    BEQ.w LAB_0019  ;0a08: 67000014
      CMPI.b #$7c,D0   ;0a0c: 0c00007c
      BNE.w LAB_0018  ;0a10: 66000006
        MOVEQ #0,D0   ;0a14: 7000
        ADDQ.w #1,D1   ;0a16: 5241
      LAB_0018:
      MOVE.b D0,(A2)+  ;0a18: 14c0
  BRA.w LAB_0017  ;0a1a: 6000ffea
  LAB_0019:
  CLR.b (A2)   ;0a1e: 4212
  CMPI.w #$0002,8(A0)  ;0a20: 0c6800020008
  BPL.w LAB_001A  ;0a26: 6a00000a
    MOVE.w D1,14(A0)  ;0a2a: 3141000e
    CLR.w 12(A0)   ;0a2e: 4268000c
  LAB_001A:
RTS    ;0a32: 4e75

LAB_001B:
  MOVEM.l 20(A0),D1/A2  ;0a34: 4ce804020014
  MOVE.w D0,28(A0)  ;0a3a: 3140001c
  CMP.w D0,D1
  BLE.w error_noroom  ;0a40: 6f0012fe
  
  LAB_001C:
    MOVE.b (A1)+,D0  ;0a44: 1019
    BEQ.w LAB_001D  ;0a46: 67000008
      MOVE.b D0,(A2)+  ;0a4a: 14c0
  BRA.w LAB_001C  ;0a4c: 6000fff6
  LAB_001D:
RTS    ;0a50: 4e75

; Page#,Box#,x,y,w,h,type
_addbox:
  TST.l (A3)   ;0a52: 4a93
  BEQ.w error_uninitpage  ;0a54: 67001294
  CMP.w $c(A3),D1
  BCC.w error_illegalboxnumber  ;0a5c: 640012a8

  ASL.w #5,D1   ;0a60: eb41
  MOVEA.l 4(A3),A0  ;0a62: 206b0004
  LEA 0(A0,D1.w),A0  ;0a66: 41f01000
  MOVEM.l 20(A0),D0/A1  ;0a6a: 4ce802010014
  TST.l D0   ;0a70: 4a80
  BEQ.w LAB_001F  ;0a72: 6700000c
    ALibJsr #globalfree
    CLR.l 20(A0)   ;0a7c: 42a80014
  LAB_001F:
  MOVEM.w D2-D5,0(A0)  ;0a80: 48a8003c0000
  MOVE.w -(A2),D0  ;0a86: 3022
  MOVE.w 18(A3),D1  ;0a88: 322b0012
  ASR.w #1,D0   ;0a8c: e240
  BCC.w LAB_0020  ;0a8e: 64000004
    NOT.w D1   ;0a92: 4641
  LAB_0020:
  MOVEM.w D0-D1,8(A0)  ;0a94: 48a800030008
  CMPI.w #$0002,D0  ;0a9a: 0c400002
  BEQ.w LAB_0021  ;0a9e: 6700000c
    CMPI.w #$0003,D0  ;0aa2: 0c400003
    BEQ.w LAB_0023  ;0aa6: 67000034
      RTS    ;0aaa: 4e75
  LAB_0021:
  LSR.w #3,D4   ;0aac: e64c
  EXT.l D4   ;0aae: 48c4
  BLE.w error_noroom  ;0ab0: 6f00128e
  
  MOVE.l D4,D0   ;0ab4: 2004
  MOVEQ #0,D1   ;0ab6: 7200
  MOVE.l D0,20(A0)  ;0ab8: 21400014
  ALibJsr #globalalloc
  MOVE.l D0,24(A0)  ;0ac2: 21400018
  MOVEA.l D0,A1   ;0ac6: 2240
  MOVE.l 20(A0),D0  ;0ac8: 20280014
  SUBQ.w #2,D0   ;0acc: 5540
  LAB_0022:
    MOVE.b #$20,(A1)+  ;0ace: 12fc0020
  DBF D0,LAB_0022  ;0ad2: 51c8fffa
  MOVE.b #$00,(A1)+  ;0ad6: 12fc0000
RTS    ;0ada: 4e75
  
LAB_0023:
  MOVEQ #-1,D2   ;0adc: 74ff
  SUBQ.w #4,D4   ;0ade: 5944
  CMPI.w #$001c,D4  ;0ae0: 0c44001c
  BMI.w LAB_0024  ;0ae4: 6b000008
    MOVE.w #$4000,D2  ;0ae8: 343c4000
    MOVEQ #12,D4   ;0aec: 780c
  LAB_0024:
  MOVEQ #-1,D3   ;0aee: 76ff
  SUBQ.w #2,D5   ;0af0: 5545
  CMPI.w #$000a,D5  ;0af2: 0c45000a
  BMI.w LAB_0025  ;0af6: 6b000008
    MOVE.w #$4000,D3  ;0afa: 363c4000
    MOVEQ #6,D5   ;0afe: 7a06
  LAB_0025:
  MOVEM.w D2-D3,12(A0)  ;0b00: 48a8000c000c
  MOVEM.w D4-D5,28(A0)  ;0b06: 48a80030001c
RTS    ;0b0c: 4e75

_redrawpage:
  TST.l (A3)   ;0b0e: 4a93
  BEQ.w error_uninitpage  ;0b10: 670011d8
  
  MOVE.l A4,-(A7)  ;0b14: 2f0c
  MOVEA.l 4(A3),A0  ;0b16: 206b0004
  MOVE.w 12(A3),D7  ;0b1a: 3e2b000c
  SUBQ.w #1,D7   ;0b1e: 5347
  BMI.w LAB_0029  ;0b20: 6b00001e
  LAB_0027:
    TST.w 4(A0)   ;0b24: 4a680004
    BEQ.w LAB_0028  ;0b28: 6700000e
      MOVEM.l D7/A0/A3,-(A7)  ;0b2c: 48e70190
      BSR.w LAB_0041  ;0b30: 6100019c
      MOVEM.l (A7)+,D7/A0/A3  ;0b34: 4cdf0980
    LAB_0028:
    ADDA.w #$0020,A0  ;0b38: d0fc0020
  DBF D7,LAB_0027  ;0b3c: 51cfffe6
  LAB_0029:
  MOVEA.l (A7)+,A4  ;0b40: 285f
RTS    ;0b42: 4e75

_redrawbox:
  TST.l (A3)   ;0b44: 4a93
  BEQ.w error_uninitpage  ;0b46: 670011a2
  CMP.w   $c(A3),D0
  BCC.w error_illegalboxnumber  ;0b4e: 640011b6

  MOVE.l A4,-(A7)  ;0b52: 2f0c
  ASL.w #5,D0   ;0b54: eb40
  MOVEA.l 4(A3),A0  ;0b56: 206b0004
  ADDA.w D0,A0   ;0b5a: d0c0
  BSR.w LAB_0041  ;0b5c: 61000170
  MOVEA.l (A7)+,A4  ;0b60: 285f
RTS    ;0b62: 4e75

_setbox:
  TST.l (A3)   ;0b64: 4a93
  BEQ.w error_uninitpage  ;0b66: 67001182
  CMP.w   $c(A3),D0
  BCC.w error_illegalboxnumber  ;0b6e: 64001196

  ASL.w #5,D0   ;0b72: eb40
  MOVEA.l 4(A3),A0  ;0b74: 206b0004
  ADDA.w D0,A0   ;0b78: d0c0
  CMPI.w #$0003,8(A0)  ;0b7a: 0c6800030008
  BNE.w error_nopropbox  ;0b80: 6600120e

  TST.l D1   ;0b84: 4a81
  BEQ.w LAB_002C  ;0b86: 67000004
    SUBQ.l #1,D1   ;0b8a: 5381
  LAB_002C:
  LSR.w #1,D1   ;0b8c: e249
  TST.l D2   ;0b8e: 4a82
  BEQ.w LAB_002D  ;0b90: 67000004
    SUBQ.l #1,D2   ;0b94: 5382
  LAB_002D:
  LSR.w #1,D2   ;0b96: e24a
  MOVEM.w 12(A0),D3-D4  ;0b98: 4ca80018000c
  TST.w D3   ;0b9e: 4a43
  BMI.w LAB_002E  ;0ba0: 6b000004
    MOVE.w D1,D3   ;0ba4: 3601
  LAB_002E:
  TST.w D4   ;0ba6: 4a44
  BMI.w LAB_002F  ;0ba8: 6b000004
    MOVE.w D2,D4   ;0bac: 3802
  LAB_002F:
  MOVEM.w D3-D4,12(A0)  ;0bae: 48a80018000c
RTS    ;0bb4: 4e75

_changebox:
  MOVE.w D1,D0   ;0bb6: 3001
  MOVE.w D2,D1   ;0bb8: 3202
BRA.w _setbox1  ;0bba: 60000002
 
 _setbox1:
  TST.l (A3)   ;0bbe: 4a93
  BEQ.w error_uninitpage  ;0bc0: 67001128
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;0bc8: 6400113c

  ASL.w #5,D0   ;0bcc: eb40
  MOVEA.l 4(A3),A0  ;0bce: 206b0004
  ADDA.w D0,A0   ;0bd2: d0c0
  TST.w D1   ;0bd4: 4a41
  BPL.w LAB_0032  ;0bd6: 6a000006
    ADD.w 14(A0),D1  ;0bda: d268000e
  LAB_0032:
  CMP.w $e(A0),D1
  BCC.w error_valueoutofrange  ;0be2: 64001140

  MOVE.w D1,12(A0)  ;0be6: 3141000c
RTS    ;0bea: 4e75

_setboxcolor:
  TST.l (A3)   ;0bec: 4a93
  BEQ.w error_uninitpage  ;0bee: 670010fa
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;0bf6: 6400110e

  MOVE.l A4,-(A7)  ;0bfa: 2f0c
  ASL.w #5,D0   ;0bfc: eb40
  MOVEA.l 4(A3),A0  ;0bfe: 206b0004
  ADDA.w D0,A0   ;0c02: d0c0
  TST.w 10(A0)   ;0c04: 4a68000a
  BPL.w LAB_0034  ;0c08: 6a000004
    NOT.w D1   ;0c0c: 4641
  LAB_0034:
  MOVE.w D1,10(A0)  ;0c0e: 3141000a
  BSR.w LAB_0041  ;0c12: 610000ba
  MOVEA.l (A7)+,A4  ;0c16: 285f
RTS    ;0c18: 4e75

_setboxstring:
  TST.l (A3)   ;0c1a: 4a93
  BEQ.w error_uninitpage  ;0c1c: 670010cc
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;0c24: 640010e0
  
  ASL.w #5,D0   ;0c28: eb40
  MOVEA.l 4(A3),A0  ;0c2a: 206b0004
  ADDA.w D0,A0   ;0c2e: d0c0
  MOVEA.l D1,A1   ;0c30: 2241
  MOVE.l -(A2),D1  ;0c32: 2222
  MOVEM.l 20(A0),D2/A2  ;0c34: 4ce804040014
  SUB.w 28(A0),D2  ;0c3a: 9468001c
  SUB.w D1,D2   ;0c3e: 9441
  BLE.w error_noroom  ;0c40: 6f0010fe
  
  ADDA.w 28(A0),A2  ;0c44: d4e8001c
  SUBQ.w #1,D1   ;0c48: 5341
  BMI.w LAB_0037  ;0c4a: 6b000008
    LAB_0036:
      MOVE.b (A1)+,(A2)+  ;0c4e: 14d9
    DBF D1,LAB_0036  ;0c50: 51c9fffc
  LAB_0037:
  SUBQ.w #2,D2   ;0c54: 5542
  BMI.w LAB_0039  ;0c56: 6b00000a
    LAB_0038:
      MOVE.b #$20,(A2)+  ;0c5a: 14fc0020
    DBF D2,LAB_0038  ;0c5e: 51cafffa
  LAB_0039:
  MOVE.b #$00,(A2)+  ;0c62: 14fc0000
RTS    ;0c66: 4e75

_boxvalue1:
  MOVE.w D1,D0   ;0c68: 3001
_boxvalue:
  TST.l (A3)   ;0c6a: 4a93
  BEQ.w error_uninitpage  ;0c6c: 6700107c
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;0c74: 64001090

  ASL.w #5,D0   ;0c78: eb40
  MOVEA.l 4(A3),A0  ;0c7a: 206b0004
  ADDA.w D0,A0   ;0c7e: d0c0
  MOVE.w 12(A0),D0  ;0c80: 3028000c
RTS    ;0c84: 4e75

_boxstring1:
  MOVE.w D1,D0   ;0c86: 3001
_boxstring:
  EXG    A1,A3
  TST.l (A3)   ;0c8a: 4a93
  BEQ.w error_uninitpage  ;0c8c: 6700105c
  CMP.w $c(A3),D0
  BCC.w error_illegalboxnumber  ;0c94: 64001070

  ASL.w #5,D0   ;0c98: eb40
  MOVEA.l 4(A3),A0  ;0c9a: 206b0004
  ADDA.w D0,A0   ;0c9e: d0c0
  MOVE.w 28(A0),D2  ;0ca0: 3428001c
  MOVEM.l 20(A0),D0/A0  ;0ca4: 4ce801010014
  ADDA.w D2,A0   ;0caa: d0c2
  SUB.w D2,D0   ;0cac: 9042
  MOVEA.l A1,A3   ;0cae: 2649
  LEA -1(A0,D0.w),A1  ;0cb0: 43f000ff
  LAB_003E:
    SUBQ.w #1,D0   ;0cb4: 5340
  CMPI.b #$20,-(A1)  ;0cb6: 0c210020
  BEQ.w LAB_003E  ;0cba: 6700fff8
  MOVE.w D0,D1   ;0cbe: 3200
  BEQ.w LAB_0040  ;0cc0: 6700000a
    SUBQ.w #1,D1   ;0cc4: 5341
    LAB_003F:
      MOVE.b (A0)+,(A3)+  ;0cc6: 16d8
    DBF D1,LAB_003F  ;0cc8: 51c9fffc
  LAB_0040:
RTS    ;0ccc: 4e75

LAB_0041:
 MOVEQ #0,D0   ;0cce: 7000
 MOVE.w 8(A0),LAB_0068  ;0cd0: 33e8000800001196
 BPL.w LAB_0042  ;0cd8: 6a00000a
  NEG.w LAB_0068  ;0cdc: 447900001196
  MOVEQ #-1,D0   ;0ce2: 70ff
 LAB_0042:
 MOVE.w D0,LAB_006E  ;0ce4: 33c0000011a2
 MOVEM.l A3-A4,-(A7)  ;0cea: 48e70018
 MOVEM.l 14(A3),D0-D1  ;0cee: 4ceb0003000e
 CLR.w LAB_006C+2  ;0cf4: 4279000011a0
 CMPA.l $16(A3),A0
 BEQ.w LAB_0043  ;0cfe: 67000010
   MOVE.w D0,D1   ;0d02: 3200
   MOVE.w #$ffff,LAB_006C+2 ;0d04: 33fcffff000011a0
   BRA.w LAB_0044  ;0d0c: 60000010
 LAB_0043:
   CMPI.w #$0004,LAB_0068  ;0d10: 0c79000400001196
   BNE.w LAB_0044  ;0d18: 66000004
     MOVE.w D1,D0   ;0d1c: 3001
 LAB_0044:
 SWAP D1   ;0d1e: 4841
 MOVE.w 10(A0),D1  ;0d20: 3228000a
 BPL.w LAB_0045  ;0d24: 6a00001a
   SWAP D0   ;0d28: 4840
   NOT.w D1   ;0d2a: 4641
   TST.w LAB_0068  ;0d2c: 4a7900001196
   BNE.w LAB_0045  ;0d32: 6600000c
     TST.l 20(A0)   ;0d36: 4aa80014
     BEQ.w LAB_0045  ;0d3a: 67000004
       MOVEQ #0,D0   ;0d3e: 7000
 LAB_0045:
 SWAP D1   ;0d40: 4841
 MOVEM.l D0-D1,LAB_0068+2 ;0d42: 48f9000300001198
 MOVEM.w 0(A0),D0-D3  ;0d4a: 4ca8000f0000
 ADD.w D0,D2   ;0d50: d440
 SUBQ.w #1,D2   ;0d52: 5342
 ADD.w D1,D3   ;0d54: d641
 SUBQ.w #1,D3   ;0d56: 5343
 MOVEM.w D0-D3,LAB_0062  ;0d58: 48b9000f0000117e
 TST.w LAB_006E  ;0d60: 4a79000011a2
 BEQ.w LAB_0046  ;0d66: 67000010
   MOVE.w LAB_006A+2(PC),D4 ;0d6a: 383a0430
   BLibJsr #sis2dlib LSL 7 + 4 ; Boxf
   BRA.w LAB_0061  ;0d74: 60000402
 LAB_0046:
   CMPI.w #$0004,LAB_0068  ;0d78: 0c79000400001196
   BEQ.w LAB_0060  ;0d80: 67000374
   CMPI.w #$0006,LAB_0068  ;0d84: 0c79000600001196
   BNE.w LAB_0047  ;0d8c: 6600000a
     TST.l 20(A0)   ;0d90: 4aa80014
     BEQ.w LAB_0060  ;0d94: 67000360
   LAB_0047:
   CMPI.w #$0001,LAB_0068  ;0d98: 0c79000100001196
   BNE.w LAB_0049  ;0da0: 6600004c
   TST.w 16(A0)   ;0da4: 4a680010
   BEQ.w LAB_0049  ;0da8: 67000044
     MOVE.l A0,-(A7)  ;0dac: 2f08
     ADDQ.w #2,D0   ;0dae: 5440
     ADDQ.w #1,D1   ;0db0: 5241
     SUBQ.w #2,D2   ;0db2: 5542
     SUBQ.w #1,D3   ;0db4: 5343
     MOVE.w LAB_0068+2(PC),D4 ;0db6: 383a03e0
     TST.w LAB_006C+2  ;0dba: 4a79000011a0
     BEQ.w LAB_0048  ;0dc0: 67000006
       MOVE.w LAB_006A+2(PC),D4 ;0dc4: 383a03d6
     LAB_0048:
     BLibJsr #sis2dlib LSL 7 + 4 ; Boxf
     MOVEA.l (A7),A0   ;0dce: 2057
     MOVE.w 18(A0),D0  ;0dd0: 30280012
     ADD.w 12(A0),D0  ;0dd4: d068000c
     MOVEM.w LAB_0062(PC),D1-D2 ;0dd8: 4cba000603a2
     ADDQ.w #2,D1   ;0dde: 5441
     ADDQ.w #1,D2   ;0de0: 5242
     BLibJsr #blitlib LSL 7 + 1 ; Blit
     MOVEA.l (A7)+,A0  ;0de8: 205f
     BRA.w LAB_0060  ;0dea: 6000030a
   LAB_0049:
   MOVE.l A0,-(A7)  ;0dee: 2f08
   ADDQ.w #2,D0   ;0df0: 5440
 ADDQ.w #1,D1   ;0df2: 5241
 SUBQ.w #2,D2   ;0df4: 5542
 SUBQ.w #1,D3   ;0df6: 5343
 MOVE.w LAB_006A+2(PC),D4 ;0df8: 383a03a2
 BLibJsr #sis2dlib LSL 7 + 4 ; Boxf
 MOVEA.l (A7)+,A0  ;0e02: 205f
 CMPI.w #$0003,LAB_0068  ;0e04: 0c79000300001196
 BNE.w LAB_004D  ;0e0c: 660000e0

 MOVEM.w 0(A0),D0-D3  ;0e10: 4ca8000f0000
 MOVEM.w 12(A0),D4-D5  ;0e16: 4ca80030000c
 MOVEM.w 28(A0),D6-D7  ;0e1c: 4ca800c0001c
 ADDQ.w #2,D0   ;0e22: 5440
 ADDQ.w #1,D1   ;0e24: 5241
 SUBQ.w #3,D2   ;0e26: 5742
 SUBQ.w #1,D3   ;0e28: 5343
 SUB.w D6,D2   ;0e2a: 9446
 SUB.w D7,D3   ;0e2c: 9647
 TST.w D4   ;0e2e: 4a44
 BMI.w LAB_004A  ;0e30: 6b00000a
   ADD.w D4,D4   ;0e34: d844
   MULU.w  D4,D2
   SWAP D2   ;0e38: 4842
   ADD.w D2,D0   ;0e3a: d042
 LAB_004A:
 TST.w D5   ;0e3c: 4a45
 BMI.w LAB_004B  ;0e3e: 6b00000a
   ADD.w D5,D5   ;0e42: da45
   MULU.w D5,D3
   SWAP D3   ;0e46: 4843
   ADD.w D3,D1   ;0e48: d243
 LAB_004B:
 ADD.w D0,D6   ;0e4a: dc40
 SUBQ.w #1,D6   ;0e4c: 5346
 ADD.w D1,D7   ;0e4e: de41
 SUBQ.w #1,D7   ;0e50: 5347
 MOVEM.w D0-D1/D6-D7,LAB_0065 ;0e52: 48b900c300001186
 MOVE.l A0,-(A7)  ;0e5a: 2f08
 TST.w LAB_006C+2  ;0e5c: 4a79000011a0
 BNE.w LAB_004C  ;0e62: 66000012
   MOVEM.w LAB_0065(PC),D0-D3 ;0e66: 4cba000f031c
   MOVE.w LAB_006C(PC),D4  ;0e6c: 383a0330
   BLibJsr #sis2dlib LSL 7 + 4 ; Boxf
 LAB_004C:
 MOVEM.w LAB_0065(PC),D0-D3 ;0e76: 4cba000f030c
 MOVE.w D1,D3   ;0e7c: 3601
 MOVE.w LAB_006A(PC),D4  ;0e7e: 383a031a
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0065(PC),D0-D3 ;0e88: 4cba000f02fa
 MOVE.w D2,D0   ;0e8e: 3002
 MOVE.w LAB_006A(PC),D4  ;0e90: 383a0308
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0065(PC),D0-D3 ;0e9a: 4cba000f02e8
 ADDQ.w #1,D2   ;0ea0: 5242
 MOVE.w D2,D0   ;0ea2: 3002
 MOVE.w LAB_006A(PC),D4  ;0ea4: 383a02f4
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0065(PC),D0-D3 ;0eae: 4cba000f02d4
 MOVE.w D0,D2   ;0eb4: 3400
 MOVE.w LAB_0068+2(PC),D4 ;0eb6: 383a02e0
 BLibJsr #sis2dlib LSL 7 + 5 ; Line 
 MOVEM.w LAB_0065(PC),D0-D3 ;0ec0: 4cba000f02c2
 SUBQ.w #1,D0   ;0ec6: 5340
 MOVE.w D0,D2   ;0ec8: 3400
 ADDQ.w #1,D1   ;0eca: 5241
 MOVE.w LAB_0068+2(PC),D4 ;0ecc: 383a02ca
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0065(PC),D0-D3 ;0ed6: 4cba000f02ac
 ADDQ.w #1,D0   ;0edc: 5240
 MOVE.w D3,D1   ;0ede: 3203
 SUBQ.w #1,D2   ;0ee0: 5342
 MOVE.w LAB_0068+2(PC),D4 ;0ee2: 383a02b4
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEA.l (A7)+,A0  ;0eec: 205f
 LAB_004D:
 CMPI.w #$0005,LAB_0068  ;0eee: 0c79000500001196
 BNE.w LAB_0056  ;0ef6: 66000106
 MOVE.w 6(A0),D0  ;0efa: 30280006
 SUBQ.w #3,D0   ;0efe: 5740
 LSR.w #3,D0   ;0f00: e648
 MOVE.w D0,LAB_0071+2  ;0f02: 33c0000011ac
 LSR.w #1,D0   ;0f08: e248
 MOVE.w 12(A0),D2  ;0f0a: 3428000c
 SUB.w D0,D2   ;0f0e: 9440
 BPL.w LAB_004E  ;0f10: 6a000004
   MOVEQ #0,D2   ;0f14: 7400
 LAB_004E:
 MOVE.w 14(A0),D0  ;0f16: 3028000e
 SUB.w LAB_0071+2(PC),D0 ;0f1a: 907a0290
 BPL.w LAB_004F  ;0f1e: 6a00000c
   MOVEQ #0,D0   ;0f22: 7000
   MOVE.w 14(A0),LAB_0071+2 ;0f24: 33e8000e000011ac
 LAB_004F:
 CMP.w D0,D2
 BMI.w LAB_0050  ;0f2e: 6b000004
   MOVE.w D0,D2   ;0f32: 3400
 LAB_0050:
 MOVE.w 12(A0),D0  ;0f34: 3028000c
 SUB.w D2,D0   ;0f38: 9042
 MOVE.w D0,LAB_0072  ;0f3a: 33c0000011ae
 MOVEA.l 24(A0),A1  ;0f40: 22680018
 BRA.w LAB_0052  ;0f44: 60000008
   LAB_0051:
     TST.b (A1)+   ;0f48: 4a19
   BNE.w LAB_0051  ;0f4a: 6600fffc
 LAB_0052:
 DBF D2,LAB_0051  ;0f4e: 51cafff8
 MOVE.l A1,LAB_0066  ;0f52: 23c90000118e
 MOVEM.w LAB_0062(PC),D0-D1 ;0f58: 4cba00030222
 ADDI.w #$000b,D0  ;0f5e: 0640000b
 LSR.w #3,D0   ;0f62: e648
 EXT.l D1   ;0f64: 48c1
 ADDQ.w #2,D1   ;0f66: 5441
 SWAP D1   ;0f68: 4841
 LSR.l #3,D1   ;0f6a: e689
 MOVEM.l D0-D1,LAB_006E+2 ;0f6c: 48f90003000011a4
 MOVE.w LAB_006A+2(PC),D1 ;0f74: 323a0226
 MOVE.w LAB_006A(PC),D0  ;0f78: 303a0220
 BLibJsr #fontlib LSL 7 + 3,1 ; Colour
 LAB_0053:
 MOVEM.l LAB_006E+2(PC),D0-D1 ;0f82: 4cfa0003021e
 BLibJsr #fontlib LSL 7 + 4 ; Locate 
 ADDI.w #$0001,LAB_0070+2 ;0f8e: 06790001000011a8
 MOVEA.l LAB_0066(PC),A0  ;0f96: 207a01f6
 MOVEA.l A0,A1   ;0f9a: 2248
 LAB_0054:
   TST.b (A1)+   ;0f9c: 4a19
 BNE.w LAB_0054  ;0f9e: 6600fffc
 MOVE.l A1,LAB_0066  ;0fa2: 23c90000118e
 BTST #6,DMACONR  ;0fa8: 0839000600dff002
 LAB_0055:
   BTST #6,DMACONR  ;0fb0: 0839000600dff002
 BNE.w LAB_0055  ;0fb8: 6600fff6
 BLibJsr #fontlib LSL 7 + $f ; ??? 
 SUBI.w #$0001,LAB_0071+2 ;0fc2: 04790001000011ac
 BGT.w LAB_0053  ;0fca: 6e00ffb6
 TST.w LAB_006C+2  ;0fce: 4a79000011a0
 BNE.w LAB_0060  ;0fd4: 66000120
 MOVEM.w LAB_0062(PC),D0-D2 ;0fd8: 4cba000701a2
 ADDQ.w #2,D0   ;0fde: 5440
 SUBQ.w #2,D2   ;0fe0: 5542
 MOVE.w LAB_0072(PC),D3  ;0fe2: 363a01ca
 ASL.w #3,D3   ;0fe6: e743
 ADD.w D3,D1   ;0fe8: d243
 ADDQ.w #1,D1   ;0fea: 5241
 MOVE.w D1,D3   ;0fec: 3601
 ADDQ.w #8,D3   ;0fee: 5043
 MOVE.w #$8001,D4  ;0ff0: 383c8001
 BLibJsr #sis2dlib LSL 7 + 4 ; Boxf
 BRA.w LAB_0060  ;0ffa: 600000fa
 LAB_0056:
 MOVEM.l 20(A0),D0-D1  ;0ffe: 4ce800030014
 TST.l D0   ;1004: 4a80
 BEQ.w LAB_005B  ;1006: 67000072
 EXG D0,D1   ;100a: c141
 CMPI.w #$0003,LAB_0068  ;100c: 0c79000300001196
 BNE.w LAB_0058  ;1014: 66000036
 MOVEM.l D0-D1,LAB_0066  ;1018: 48f900030000118e
 MOVE.w D1,D2   ;1020: 3401
 MOVEM.w LAB_0062(PC),D0-D1 ;1022: 4cba00030158
 ADDI.w #$000b,D0  ;1028: 0640000b
 LSR.w #3,D0   ;102c: e648
 SUBQ.w #8,D1   ;102e: 5141
 TST.w 28(A0)   ;1030: 4a68001c
 BMI.w LAB_0057  ;1034: 6b000006
 ADDQ.w #8,D1   ;1038: 5041
 SUB.w D2,D0   ;103a: 9042
LAB_0057:
 ADDQ.w #2,D1   ;103c: 5441
 SWAP D1   ;103e: 4841
 LSR.l #3,D1   ;1040: e689
 BLibJsr #fontlib LSL 7 + 4 ; Locate
 BRA.w LAB_005E  ;1048: 6000007c
LAB_0058:
 CMPI.w #$0006,LAB_0068  ;104c: 0c79000600001196
 BEQ.w LAB_005B  ;1054: 67000024
 TST.w 14(A0)   ;1058: 4a68000e
 BEQ.w LAB_005B  ;105c: 6700001c
 MOVE.w 12(A0),D2  ;1060: 3428000c
 MOVEA.l D0,A1   ;1064: 2240
LAB_0059:
 MOVEQ #0,D1   ;1066: 7200
LAB_005A:
 ADDQ.w #1,D1   ;1068: 5241
 TST.b (A1)+   ;106a: 4a19
 BNE.w LAB_005A  ;106c: 6600fffa
 DBF D2,LAB_0059  ;1070: 51cafff4
 SUBA.l D1,A1   ;1074: 93c1
 SUBQ.w #1,D1   ;1076: 5341
 MOVE.l A1,D0   ;1078: 2009
LAB_005B:
 MOVEM.l D0-D1,LAB_0066  ;107a: 48f900030000118e
 MOVE.l LAB_0067(PC),D0  ;1082: 203a010e
 BEQ.w LAB_0060  ;1086: 6700006e
 CMPI.w #$0002,LAB_0068  ;108a: 0c79000200001196
 BNE.w LAB_005C  ;1092: 66000010
 MOVE.w LAB_0062(PC),D0  ;1096: 303a00e6
 ADDI.w #$000b,D0  ;109a: 0640000b
 LSR.w #3,D0   ;109e: e648
 BRA.w LAB_005D  ;10a0: 60000012
LAB_005C:
 NEG.w D0   ;10a4: 4440
 ASL.w #3,D0   ;10a6: e740
 ADD.w LAB_0062(PC),D0  ;10a8: d07a00d4
 ADD.w LAB_0064(PC),D0  ;10ac: d07a00d4
 ADDQ.w #7,D0   ;10b0: 5e40
 LSR.w #4,D0   ;10b2: e848
LAB_005D:
 MOVE.w LAB_0062+2(PC),D1 ;10b4: 323a00ca
 EXT.l D1   ;10b8: 48c1
 ADDQ.w #2,D1   ;10ba: 5441
 SWAP D1   ;10bc: 4841
 LSR.l #3,D1   ;10be: e689
 BLibJsr #fontlib LSL 7 + 4 ; Locate
LAB_005E:
 MOVE.w LAB_006A+2(PC),D1 ;10c6: 323a00d4
 MOVE.w LAB_006C(PC),D0  ;10ca: 303a00d2
 BLibJsr #fontlib LSL 7 + 3,1 ; Colour
 BTST #6,DMACONR  ;10d4: 0839000600dff002
LAB_005F:
 BTST #6,DMACONR  ;10dc: 0839000600dff002
 BNE.w LAB_005F  ;10e4: 6600fff6
 MOVEM.l LAB_0066(PC),D0/A0 ;10e8: 4cfa010100a2
 ;DC.w $c188   ;10ee
 EXG     D0,A0
 BLibJsr #fontlib LSL 7 + $e ; ???
LAB_0060:
 TST.l LAB_0068+2  ;10f6: 4ab900001198
 BEQ.w LAB_0061  ;10fc: 6700007a
 MOVEM.w LAB_0062(PC),D0-D3 ;1100: 4cba000f007a
 MOVE.w D1,D3   ;1106: 3601
 MOVE.w LAB_0068+2(PC),D4 ;1108: 383a008e
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0062(PC),D0-D3 ;1112: 4cba000f0068
 MOVE.w D2,D0   ;1118: 3002
 MOVE.w LAB_006A(PC),D4  ;111a: 383a007e
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0062(PC),D0-D3 ;1124: 4cba000f0056
 SUBQ.w #1,D2   ;112a: 5342
 MOVE.w D2,D0   ;112c: 3002
 ADDQ.w #1,D1   ;112e: 5241
 MOVE.w LAB_006A(PC),D4  ;1130: 383a0068
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0062(PC),D0-D3 ;113a: 4cba000f0040
 MOVE.w D0,D2   ;1140: 3400
 MOVE.w LAB_0068+2(PC),D4 ;1142: 383a0054
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0062(PC),D0-D3 ;114c: 4cba000f002e
 ADDQ.w #1,D0   ;1152: 5240
 MOVE.w D0,D2   ;1154: 3400
 ADDQ.w #1,D1   ;1156: 5241
 MOVE.w LAB_0068+2(PC),D4 ;1158: 383a003e
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 MOVEM.w LAB_0062(PC),D0-D3 ;1162: 4cba000f0018
 ADDQ.w #1,D0   ;1168: 5240
 MOVE.w D3,D1   ;116a: 3203
 SUBQ.w #1,D2   ;116c: 5342
 MOVE.w LAB_006A(PC),D4  ;116e: 383a002a
 BLibJsr #sis2dlib LSL 7 + 5 ; Line
 LAB_0061:
 MOVEM.l (A7)+,A3-A4  ;1178: 4cdf1800
RTS    ;117c: 4e75

LAB_0062: ORI.b #$00,D0   ;117e: 00000000
LAB_0064: ORI.b #$00,D0   ;1182: 00000000
LAB_0065: ORI.b #$00,D0   ;1186: 00000000
          ORI.b #$00,D0   ;118a: 00000000
LAB_0066: ORI.b #$00,D0   ;118e: 00000000
LAB_0067: ORI.b #$00,D0   ;1192: 00000000
LAB_0068: ORI.b #$00,D0   ;1196: 00000000
LAB_006A: ORI.b #$00,D0   ;119a: 00000000
LAB_006C: ORI.b #$00,D0   ;119e: 00000000 ;Colours
LAB_006E: ORI.b #$00,D0   ;11a2: 00000000
LAB_0070: ORI.b #$00,D0   ;11a6: 00000000
LAB_0071: ORI.b #$00,D0   ;11aa: 00000000
LAB_0072: Dc.w $0000   ;11ae

_spotbox:
  MOVEM.w LAB_00F3+2(PC),D0-D1 ;11b0: 4cba00030b2c
  MOVEA.l 4(A3),A0  ;11b6: 206b0004
  MOVE.w 12(A3),D7  ;11ba: 3e2b000c
  SUBQ.w #1,D7   ;11be: 5347
  MOVEQ #0,D6   ;11c0: 7c00
 LAB_0074:
  TST.w 8(A0)   ;11c2: 4a680008
  BLE.w LAB_0075  ;11c6: 6f000024
  MOVEM.w 0(A0),D2-D5  ;11ca: 4ca8003c0000
  SUB.w D0,D2   ;11d0: 9440
  BGT.w LAB_0075  ;11d2: 6e000018
  SUB.w D1,D3   ;11d6: 9641
  BGT.w LAB_0075  ;11d8: 6e000012
  NEG.w D2   ;11dc: 4442
  NEG.w D3   ;11de: 4443
  ;DC.w $b842   ;11e0
  CMP.w   D2,D4
  BLE.w LAB_0075  ;11e2: 6f000008
  ;DC.w $ba43   ;11e6
  CMP.w D3,D5
  BGT.w LAB_0076  ;11e8: 6e000010
  LAB_0075:
  ADDQ.w #1,D6   ;11ec: 5246
  ADDA.w #$0020,A0  ;11ee: d0fc0020
  DBF  D7,LAB_0074  ;11f2: 51cfffce
  MOVEQ #-1,D0   ;11f6: 70ff
  RTS    ;11f8: 4e75
  LAB_0076:
  MOVE.w D6,D0   ;11fa: 3006
RTS    ;11fc: 4e75

_selectbox2:
  TST.l (A3)   ;11fe: 4a93
  BEQ.w error_uninitpage  ;1200: 67000ae8
  MOVE.l A4,-(A7)  ;1204: 2f0c
  MOVE.l 22(A3),-(A7)  ;1206: 2f2b0016
  MOVE.w D1,D0   ;120a: 3001
  MOVE.w D2,D1   ;120c: 3202
  MOVEA.l 4(A3),A0  ;120e: 206b0004
  MOVE.w 12(A3),D7  ;1212: 3e2b000c
  SUBQ.w #1,D7   ;1216: 5347
 LAB_0078:
  TST.w 8(A0)   ;1218: 4a680008
  BLE.w LAB_0079  ;121c: 6f000024
  MOVEM.w 0(A0),D2-D5  ;1220: 4ca8003c0000
  SUB.w D0,D2   ;1226: 9440
  BGT.w LAB_0079  ;1228: 6e000018
  SUB.w D1,D3   ;122c: 9641
  BGT.w LAB_0079  ;122e: 6e000012
  NEG.w D2   ;1232: 4442
  NEG.w D3   ;1234: 4443
  ;DC.w $b842   ;1236
  CMP.w D2,D4
  BLE.w LAB_0079  ;1238: 6f000008
  ;DC.w $ba43   ;123c
  CMP.w D3,D5
  BGT.w LAB_007A  ;123e: 6e000012
 LAB_0079:
  ADDA.w #$0020,A0  ;1242: d0fc0020
  DBF D7,LAB_0078  ;1246: 51cfffd0
  MOVE.l (A7)+,D0  ;124a: 201f
  MOVEA.l (A7)+,A4  ;124c: 285f
  MOVEQ #0,D0   ;124e: 7000
  RTS    ;1250: 4e75
 LAB_007A:
  MOVE.l A0,22(A3)  ;1252: 27480016
  BSR.w LAB_0041  ;1256: 6100fa76
  MOVE.l (A7)+,D0  ;125a: 201f
  BEQ.w LAB_007B  ;125c: 67000008
  MOVEA.l D0,A0   ;1260: 2040
  BSR.w LAB_0041  ;1262: 6100fa6a
 LAB_007B:
  MOVEA.l (A7)+,A4  ;1266: 285f
  MOVE.w #$ffff,D0  ;1268: 303cffff
RTS    ;126c: 4e75

_selectbox1:
  TST.l (A3)   ;126e: 4a93
  BEQ.w error_uninitpage  ;1270: 67000a78
  MOVE.l A4,-(A7)  ;1274: 2f0c
  MOVE.w D1,D2   ;1276: 3401
  MOVE.w D0,D1   ;1278: 3200
  MOVE.l 22(A3),D0  ;127a: 202b0016
  BEQ.w LAB_0087  ;127e: 670000b6
  MOVEA.l D0,A0   ;1282: 2040
  MOVEA.l D0,A2   ;1284: 2440
  MOVEA.l 4(A3),A1  ;1286: 226b0004
  MOVEM.w 0(A0),D4-D7  ;128a: 4ca800f00000
  TST.w D1   ;1290: 4a41
  BLE.w LAB_007D  ;1292: 6f000004
  ADD.w D6,D4   ;1296: d846
 LAB_007D:
  TST.w D2   ;1298: 4a42
  BLE.w LAB_007E  ;129a: 6f000006
  ADD.w D7,D5   ;129e: da47
  SUBQ.w #1,D5   ;12a0: 5345
 LAB_007E:
  MOVE.w #$2000,D0  ;12a2: 303c2000
  MOVE.w 12(A3),D3  ;12a6: 362b000c
  SUBQ.w #1,D3   ;12aa: 5343
 LAB_007F:
  ;DC.w $b1c9   ;12ac
  CMPA.l  A1,A0
  BEQ.w LAB_0086  ;12ae: 67000068
  TST.w 8(A1)   ;12b2: 4a690008
  BLE.w LAB_0086  ;12b6: 6f000060
  MOVEM.w 0(A1),D6-D7  ;12ba: 4ca900c00000
  SUB.w D4,D6   ;12c0: 9c44
  TST.w D1   ;12c2: 4a41
  BPL.w LAB_0080  ;12c4: 6a000004
  NEG.w D6   ;12c8: 4446
 LAB_0080:
  TST.w D6   ;12ca: 4a46
  BPL.w LAB_0081  ;12cc: 6a00000a
  TST.w D1   ;12d0: 4a41
  BNE.w LAB_0086  ;12d2: 66000044
  NEG.w D6   ;12d6: 4446
 LAB_0081:
  SUB.w D5,D7   ;12d8: 9e45
  TST.w D2   ;12da: 4a42
  BPL.w LAB_0082  ;12dc: 6a000004
  NEG.w D7   ;12e0: 4447
 LAB_0082:
  TST.w D7   ;12e2: 4a47
  BPL.w LAB_0083  ;12e4: 6a00000a
  TST.w D2   ;12e8: 4a42
  BNE.w LAB_0086  ;12ea: 6600002c
  NEG.w D7   ;12ee: 4447
 LAB_0083:
  TST.w D1   ;12f0: 4a41
  BEQ.w LAB_0084  ;12f2: 6700000a
  TST.w D6   ;12f6: 4a46
  BEQ.w LAB_0086  ;12f8: 6700001e
  ASL.w #5,D7   ;12fc: eb47
 LAB_0084:
  TST.w D2   ;12fe: 4a42
  BEQ.w LAB_0085  ;1300: 6700000a
  TST.w D7   ;1304: 4a47
  BEQ.w LAB_0086  ;1306: 67000010
  ASL.w #5,D6   ;130a: eb46
 LAB_0085:
  ADD.w D6,D7   ;130c: de46
  ;DC.w $b047   ;130e
  CMP.w  D7,D0
  BCS.w LAB_0086  ;1310: 65000006
  MOVE.w D7,D0   ;1314: 3007
  MOVEA.l A1,A2   ;1316: 2449
 LAB_0086:
  ADDA.w #$0020,A1  ;1318: d2fc0020
  DBF D3,LAB_007F  ;131c: 51cbff8e
  ;DC.w $b1ca   ;1320
  CMPA.l  A2,A0
  BEQ.w LAB_0087  ;1322: 67000012
  MOVE.l A2,22(A3)  ;1326: 274a0016
  BSR.w LAB_0041  ;132a: 6100f9a2
  MOVEA.l 22(A3),A0  ;132e: 206b0016
  BSR.w LAB_0041  ;1332: 6100f99a
 LAB_0087:
  MOVEA.l (A7)+,A4  ;1336: 285f
RTS    ;1338: 4e75

_selectbox:
  TST.l (A3)   ;133a: 4a93
  BEQ.w error_uninitpage  ;133c: 670009ac
  MOVE.l A4,-(A7)  ;1340: 2f0c
  MOVE.l 22(A3),-(A7)  ;1342: 2f2b0016
  CLR.l 22(A3)   ;1346: 42ab0016
  ASL.w #5,D0   ;134a: eb40
  BMI.w LAB_0089  ;134c: 6b000010
  MOVEA.l 4(A3),A0  ;1350: 206b0004
  ADDA.w D0,A0   ;1354: d0c0
  MOVE.l A0,22(A3)  ;1356: 27480016
  BSR.w LAB_0041  ;135a: 6100f972
 LAB_0089:
  MOVE.l (A7)+,D0  ;135e: 201f
  BEQ.w LAB_008A  ;1360: 67000008
  MOVEA.l D0,A0   ;1364: 2040
  BSR.w LAB_0041  ;1366: 6100f966
 LAB_008A:
  MOVEA.l (A7)+,A4  ;136a: 285f
RTS    ;136c: 4e75

_boxshow:
  TST.l (A3)   ;136e: 4a93
  BEQ.w error_uninitpage  ;1370: 67000978
  ;DC.w $b06b   ;1374
  ;DC.w $000c   ;1376
  CMP.w   $c(A3),D0
  BCC.w error_illegalboxnumber  ;1378: 6400098c
  ASL.w #5,D0   ;137c: eb40
  MOVEA.l 4(A3),A0  ;137e: 206b0004
  ADDA.w D0,A0   ;1382: d0c0
  TST.w 8(A0)   ;1384: 4a680008
  BNE.w error_illegalboxtype  ;1388: 660009d2
  MOVE.l A2,12(A0)  ;138c: 214a000c
  MOVEM.w D2-D3,16(A0)  ;1390: 48a8000c0010
  BRA.w LAB_008D  ;1396: 6000002c
_boxshow1:
  TST.l (A3)   ;139a: 4a93
  BEQ.w error_uninitpage  ;139c: 6700094c
  ;DC.w $b06b   ;13a0
  ;DC.w $000c   ;13a2
  CMP.w   $c(A3),D0
  BCC.w error_illegalboxnumber  ;13a4: 64000960
  ASL.w #5,D0   ;13a8: eb40
  MOVEA.l 4(A3),A0  ;13aa: 206b0004
  ADDA.w D0,A0   ;13ae: d0c0
  TST.w 8(A0)   ;13b0: 4a680008
  BNE.w error_illegalboxtype  ;13b4: 660009a6
  ADD.w D1,16(A0)  ;13b8: d3680010
  ADD.w D2,18(A0)  ;13bc: d5680012
  BRA.w LAB_008D  ;13c0: 60000002
 LAB_008D:
  MOVEM.w 16(A0),D0-D1  ;13c4: 4ca800030010
  MOVEM.w 0(A0),D2-D5  ;13ca: 4ca8003c0000
  MOVEA.l 12(A0),A1  ;13d0: 2268000c
  ADDQ.w #4,D2   ;13d4: 5842
  ADDQ.w #2,D3   ;13d6: 5443
  SUBQ.w #8,D4   ;13d8: 5144
  SUBQ.w #4,D5   ;13da: 5945
  TST.w D0   ;13dc: 4a40
  BPL.w LAB_008E  ;13de: 6a000004
  MOVEQ #0,D0   ;13e2: 7000
 LAB_008E:
  TST.w D1   ;13e4: 4a41
  BPL.w LAB_008F  ;13e6: 6a000004
  MOVEQ #0,D1   ;13ea: 7200
 LAB_008F:
  MOVEM.w 56(A1),D6-D7  ;13ec: 4ca900c00038
  SUB.w D4,D6   ;13f2: 9c44
  SUB.w D5,D7   ;13f4: 9e45
  ;DC.w $bc40   ;13f6
  CMP.w   D0,D6
  BCC.w LAB_0090  ;13f8: 64000004
  MOVE.w D6,D0   ;13fc: 3006
 LAB_0090:
  ;DC.w $be41   ;13fe
  CMP.w D1,D7
  BCC.w LAB_0091  ;1400: 64000004
  MOVE.w D7,D1   ;1404: 3207
 LAB_0091:
  MOVEM.w D0-D1,16(A0)  ;1406: 48a800030010
  LEA LAB_0064(PC),A2  ;140c: 45fafd74
  EXG D4,D5   ;1410: c945
  MOVEM.w D4-D5,-4(A2)  ;1412: 48aa0030fffc
  MOVEA.l A1,A0   ;1418: 2049
  LEA HARDBASE,A1  ;141a: 43f900dff000
  MOVEA.l 8(A3),A3  ;1420: 266b0008
  BLibJsr #scrolllib LSL 7 + 2 ; ???
RTS    ;142a: 4e75

_boxprint1:
  MOVE.l (A2),D1   ;142c: 2212
  BEQ.w error_uninitbank  ;142e: 67000946
  MOVEA.l D1,A2   ;1432: 2441
  SUBQ.w #1,D2   ;1434: 5342
  BMI.w LAB_0095  ;1436: 6b000014
 LAB_0093:
  MOVE.b (A2)+,D1  ;143a: 121a
  BEQ.w LAB_0094  ;143c: 6700000a
  CMPI.b #$0a,D1   ;1440: 0c01000a
  BNE.w LAB_0093  ;1444: 6600fff4
 LAB_0094:
  DBF D2,LAB_0093  ;1448: 51cafff0
 LAB_0095:
  MOVE.l A2,D1   ;144c: 220a
  MOVEQ #-1,D3   ;144e: 76ff
 LAB_0096:
  ADDQ.l #1,D3   ;1450: 5283
  MOVE.b (A2)+,D2  ;1452: 141a
  BEQ.w LAB_0097  ;1454: 6700000e
  CMPI.b #$0a,D2   ;1458: 0c02000a
  BNE.w LAB_0096  ;145c: 6600fff2
  CLR.b -1(A2)   ;1460: 422affff
 LAB_0097:
  LEA LAB_0098(PC),A2  ;1464: 45fa0008
  MOVE.l D3,(A2)+  ;1468: 24c3
  BRA.w _boxprint  ;146a: 60000006
 LAB_0098:
  ORI.b #$00,D0   ;146e: 00000000
_boxprint:
  TST.l (A3)   ;1472: 4a93
  BEQ.w error_uninitpage  ;1474: 67000874
  MOVE.l A4,-(A7)  ;1478: 2f0c
  ;DC.w $b06b   ;147a
  ;DC.w $000c   ;147c
  CMP.w   $c(A3),D0
  BCC.w error_illegalboxnumber  ;147e: 64000886
  ASL.w #5,D0   ;1482: eb40
  MOVEA.l 4(A3),A0  ;1484: 206b0004
  ADDA.w D0,A0   ;1488: d0c0
  TST.w 8(A0)   ;148a: 4a680008
  BNE.w error_illegalboxtype  ;148e: 660008cc
  MOVE.l -4(A2),D7  ;1492: 2e2afffc
  MOVEM.l D1/D7,-(A7)  ;1496: 48e74100
  CMPI.w #$0010,6(A0)  ;149a: 0c6800100006
  BCC.w LAB_009B  ;14a0: 64000090
  MOVEM.w 0(A0),D2-D5  ;14a4: 4ca8003c0000
  MOVE.w D2,D0   ;14aa: 3002
  ADDI.w #$000b,D2  ;14ac: 0642000b
  LSR.w #3,D2   ;14b0: e64a
  ADDQ.w #2,D3   ;14b2: 5443
  MOVEM.w D2-D3,LAB_009D  ;14b4: 48b9000c000015d2
  ASL.w #3,D2   ;14bc: e742
  SUB.w D2,D0   ;14be: 9042
  ADD.w D4,D0   ;14c0: d044
  SUBQ.w #1,D0   ;14c2: 5340
  LSR.w #3,D0   ;14c4: e648
  ADD.w D0,LAB_009D  ;14c6: d179000015d2
  ASL.w #3,D0   ;14cc: e740
  MOVE.w D3,D1   ;14ce: 3203
  ASL.w #3,D7   ;14d0: e747
  MOVE.w D0,D4   ;14d2: 3800
  SUB.w D7,D4   ;14d4: 9847
  MOVEQ #8,D5   ;14d6: 7a08
  MOVE.w D2,D0   ;14d8: 3002
  ADD.w D7,D0   ;14da: d047
  EXG D4,D5   ;14dc: c945
  MOVEM.w D4-D5,-4(A2)  ;14de: 48aa0030fffc
  MOVE.l A3,-(A7)  ;14e4: 2f0b
  LEA HARDBASE,A1  ;14e6: 43f900dff000
  MOVEA.l 8(A3),A3  ;14ec: 266b0008
  MOVEA.l A3,A0   ;14f0: 204b
  BLibJsr #scrolllib LSL 7 + 2 ; ???
  BTST #6,DMACONR  ;14f8: 0839000600dff002
 LAB_009A:
  BTST #6,DMACONR  ;1500: 0839000600dff002
  BNE.w LAB_009A  ;1508: 6600fff6
  MOVEA.l (A7)+,A3  ;150c: 265f
  MOVEM.l (A7)+,D6-D7  ;150e: 4cdf00c0
  MOVEM.w LAB_009D(PC),D0-D1 ;1512: 4cba000300bc
  SWAP D1   ;1518: 4841
  LSR.l #3,D1   ;151a: e689
  SUB.w D7,D0   ;151c: 9047
  BLibJsr #fontlib LSL 7 + 4 ; Locate
  MOVEA.l D6,A0   ;1524: 2046
  MOVE.l D7,D0   ;1526: 2007
  BLibJsr #fontlib LSL 7 + $e ; ???
  MOVEA.l (A7)+,A4  ;152e: 285f
  RTS    ;1530: 4e75
  LAB_009B:
  MOVEM.w 0(A0),D2-D5  ;1532: 4ca8003c0000
  ADDQ.w #4,D2   ;1538: 5842
  ADDQ.w #2,D3   ;153a: 5443
  SUBQ.w #8,D4   ;153c: 5144
  SUBI.w #$000c,D5  ;153e: 0445000c
  MOVE.w D2,D0   ;1542: 3002
  MOVE.w D3,D1   ;1544: 3203
  ADDQ.w #8,D1   ;1546: 5041
  EXG D4,D5   ;1548: c945
  MOVEM.w D4-D5,-4(A2)  ;154a: 48aa0030fffc
  MOVEM.l A0/A3,-(A7)  ;1550: 48e70090
  LEA HARDBASE,A1  ;1554: 43f900dff000
  MOVEA.l 8(A3),A3  ;155a: 266b0008
  MOVEA.l A3,A0   ;155e: 204b
  BLibJsr #scrolllib LSL 7 + 2 ; ???
  MOVEM.l (A7),A0/A3  ;1566: 4cd70900
  MOVEM.w 0(A0),D0-D3  ;156a: 4ca8000f0000
  ADD.w D0,D2   ;1570: d440
  ADDQ.w #2,D0   ;1572: 5440
  SUBQ.w #3,D2   ;1574: 5742
  ADD.w D3,D1   ;1576: d243
  MOVE.w D1,D3   ;1578: 3601
  SUBI.w #$000a,D1  ;157a: 0441000a
  SUBQ.w #2,D3   ;157e: 5543
  MOVE.w 18(A3),D4  ;1580: 382b0012
  BLibJsr #sis2dlib LSL 7 + 4 ; Boxf
  BTST #6,DMACONR  ;158a: 0839000600dff002
 LAB_009C:
  BTST #6,DMACONR  ;1592: 0839000600dff002
  BNE.w LAB_009C  ;159a: 6600fff6
  MOVEM.l (A7)+,A0/A3  ;159e: 4cdf0900
  MOVEM.l (A7)+,D6-D7  ;15a2: 4cdf00c0
  MOVEM.w 0(A0),D0-D3  ;15a6: 4ca8000f0000
  ADDI.w #$000b,D0  ;15ac: 0640000b
  LSR.w #3,D0   ;15b0: e648
  ADD.w D3,D1   ;15b2: d243
  SUBI.w #$000a,D1  ;15b4: 0441000a
  EXT.l D1   ;15b8: 48c1
  SWAP D1   ;15ba: 4841
  LSR.l #3,D1   ;15bc: e689
  BLibJsr #fontlib LSL 7 + 4 ; Locate
  MOVEA.l D6,A0   ;15c4: 2046
  MOVE.l D7,D0   ;15c6: 2007
  BLibJsr #fontlib LSL 7 + $e ; ???
  MOVEA.l (A7)+,A4  ;15ce: 285f
RTS    ;15d0: 4e75

LAB_009D: ORI.b #$00,D0   ;15d2: 00000000

_boxselected:
  TST.l (A3)   ;15d6: 4a93
  BEQ.w error_uninitpage  ;15d8: 67000710
  MOVE.l 22(A3),D0  ;15dc: 202b0016
  BEQ.w LAB_009F  ;15e0: 6700000e
    SUB.l 4(A3),D0  ;15e4: 90ab0004
    BMI.w LAB_009F  ;15e8: 6b000006
    LSR.w #5,D0   ;15ec: ea48
  RTS    ;15ee: 4e75
  LAB_009F:
   MOVEQ #-1,D0   ;15f0: 70ff
 RTS    ;15f2: 4e75

_deselectbox:
  TST.l (A3)   ;15f4: 4a93
  BEQ.w error_uninitpage  ;15f6: 670006f2
  MOVE.l A4,-(A7)  ;15fa: 2f0c
  MOVE.l 22(A3),D0  ;15fc: 202b0016
  BEQ.w LAB_00A2  ;1600: 67000026
  MOVEA.l D0,A0   ;1604: 2040
  TST.w 10(A0)   ;1606: 4a68000a
  BPL.w LAB_00A1  ;160a: 6a000006
  NOT.w 10(A0)   ;160e: 4668000a
 LAB_00A1:
  BSR.w LAB_0041  ;1612: 6100f6ba
  CLR.w LAB_00A9  ;1616: 4279000016ce
  CLR.w LAB_00A9+2  ;161c: 4279000016d0
  CLR.w LAB_00AB  ;1622: 4279000016d2
 LAB_00A2:
  MOVEA.l (A7)+,A4  ;1628: 285f
RTS    ;162a: 4e75

_activateselectedbox:
 TST.l (A3)   ;162c: 4a93
 BEQ.w error_uninitpage  ;162e: 670006ba
 MOVE.l A4,-(A7)  ;1632: 2f0c
 MOVE.l 22(A3),D0  ;1634: 202b0016
 BEQ.w LAB_00A4  ;1638: 67000036
 MOVEA.l D0,A0   ;163c: 2040
 CMPI.w #$0001,8(A0)  ;163e: 0c6800010008
 BEQ.w LAB_00A5  ;1644: 6700002e
 CMPI.w #$0002,8(A0)  ;1648: 0c6800020008
 BEQ.w LAB_00A6  ;164e: 6700002c
 CMPI.w #$0003,8(A0)  ;1652: 0c6800030008
 BEQ.w LAB_00A7  ;1658: 67000054
 CMPI.w #$0005,8(A0)  ;165c: 0c6800050008
 BEQ.w LAB_00A5  ;1662: 67000010
 CMPI.w #$0006,8(A0)  ;1666: 0c6800060008
 BEQ.w LAB_00A8  ;166c: 67000050
 LAB_00A4:
 MOVEA.l (A7)+,A4  ;1670: 285f
 RTS    ;1672: 4e75
 LAB_00A5:
 BSR.w LAB_0041  ;1674: 6100f658
 BRA.w LAB_00A4  ;1678: 6000fff6
 LAB_00A6:
 MOVEM.w 0(A0),D0-D1  ;167c: 4ca800030000
 ADDI.w #$000b,D0  ;1682: 0640000b
 LSR.w #3,D0   ;1686: e648
 ADD.w 28(A0),D0  ;1688: d068001c
 ASL.w #3,D0   ;168c: e740
 ADDQ.w #2,D1   ;168e: 5441
 MOVEQ #0,D2   ;1690: 7400
 MOVEM.w D0-D2,LAB_00AB+2 ;1692: 48b90007000016d4
 MOVE.w #$ffff,LAB_00A9+2 ;169a: 33fcffff000016d0
 BSR.w LAB_0041  ;16a2: 6100f62a
 BSR.w LAB_00DE  ;16a6: 610004ce
 BRA.w LAB_00A4  ;16aa: 6000ffc4
 LAB_00A7:
 MOVE.w #$ffff,LAB_00A9  ;16ae: 33fcffff000016ce
 BSR.w LAB_0041  ;16b6: 6100f616
 BRA.w LAB_00A4  ;16ba: 6000ffb4
 LAB_00A8:
 MOVE.w #$ffff,LAB_00AB  ;16be: 33fcffff000016d2
 BSR.w LAB_0041  ;16c6: 6100f606
BRA.w LAB_00A4  ;16ca: 6000ffa4

LAB_00A9: ORI.b #$00,D0   ;16ce: 00000000
LAB_00AB: ORI.b #$00,D0   ;16d2: 00000000
LAB_00AD: ORI.b #$00,D0   ;16d6: 00000000

_mouseenabled:
  TST.w LAB_00AB  ;16da: 4a79000016d2
  BNE.w LAB_00AF  ;16e0: 6600000a
    MOVE.w LAB_00EF+2,D0  ;16e4: 303900001cd8
    RTS    ;16ea: 4e75
  LAB_00AF:
   MOVEQ #0,D0   ;16ec: 7000
 RTS    ;16ee: 4e75

_blitzevent:
  MOVEM.l A3-A4,-(A7)  ;16f0: 48e70018
  MOVEQ #1,D0   ;16f4: 7001
  BLibJsr #gameiolib LSL 7 + 1 ; JoyX
  MOVE.w D0,LAB_00F1  ;16fc: 33c000001cda
  MOVEQ #1,D0   ;1702: 7001
  BLibJsr #gameiolib LSL 7 + 2 ; JoyY
  MOVE.w D0,LAB_00F1+2  ;170a: 33c000001cdc
  MOVEQ #1,D0   ;1710: 7001
  BLibJsr #gameiolib LSL 7 + 4 ; JoyB
  BCLR #1,D0   ;1718: 08800001
  MOVE.w D0,LAB_00F3  ;171c: 33c000001cde
  MOVEQ #0,D0   ;1722: 7000
  BLibJsr #gameiolib LSL 7 + 4 ; JoyB
  MOVE.w D0,LAB_00F5+2  ;172a: 33c000001ce4
  TST.w LAB_00EF+2  ;1730: 4a7900001cd8
  BNE.w LAB_00B2  ;1736: 66000022
  BLibJsr #mouselib LSL 7 + 6 ; MouseXSpeed
  TST.l D0   ;1740: 4a80
  BPL.w LAB_00B1  ;1742: 6a000004
    NEG.l D0   ;1746: 4480
  LAB_00B1:
  CMPI.l #$00050000,D0  ;1748: 0c8000050000
  BMI.w LAB_00B3  ;174e: 6b000030
  MOVE.w #$ffff,LAB_00EF+2 ;1752: 33fcffff00001cd8
  LAB_00B2:
  MOVE.l LAB_00F3+2,LAB_00F8 ;175a: 23f900001ce000001ce6
  BLibJsr #mouselib LSL 7 + 4 ; MouseX
  SWAP D0   ;176a: 4840
  MOVE.w D0,LAB_00F3+2  ;176c: 33c000001ce0
  BLibJsr #mouselib LSL 7 + 5 ; MouseY
  SWAP D0   ;1778: 4840
  MOVE.w D0,LAB_00F5  ;177a: 33c000001ce2
  LAB_00B3:
  MOVE.w LAB_00F1(PC),D2  ;1780: 343a0558
  BEQ.w LAB_00B4  ;1784: 67000008
    ADDQ.w #3,D2   ;1788: 5642
    BRA.w LAB_00B5  ;178a: 6000000c
  LAB_00B4:
  MOVE.w LAB_00F1+2(PC),D2 ;178e: 343a054c
  BEQ.w LAB_00B5  ;1792: 67000004
    ADDQ.w #2,D2   ;1796: 5442
  LAB_00B5:
  MOVE.w #$004c,D0  ;1798: 303c004c
  BLibJsr #rawkeystatus
  BEQ.w LAB_00B6  ;17a2: 67000004
    MOVEQ #1,D2   ;17a6: 7401
  LAB_00B6:
  MOVE.w #$004d,D0  ;17a8: 303c004d
  BLibJsr #rawkeystatus
  BEQ.w LAB_00B7  ;17b2: 67000004
    MOVEQ #3,D2   ;17b6: 7403
  LAB_00B7:
  MOVE.w #$004e,D0  ;17b8: 303c004e
  BLibJsr #rawkeystatus
  BEQ.w LAB_00B8  ;17c2: 67000004
    MOVEQ #4,D2   ;17c6: 7404
  LAB_00B8:
  MOVE.w #$004f,D0  ;17c8: 303c004f
  BLibJsr #rawkeystatus
  BEQ.w LAB_00B9  ;17d2: 67000004
    MOVEQ #2,D2   ;17d6: 7402
  LAB_00B9:
  MOVE.w #$0064,D0  ;17d8: 303c0064
  BLibJsr #rawkeystatus
  BEQ.w LAB_00BA  ;17e2: 67000018
    MOVE.w #$0066,D0  ;17e6: 303c0066
    BLibJsr #rawkeystatus
    BEQ.w LAB_00BA  ;17f0: 6700000a
      BSET #0,LAB_00F5+3  ;17f4: 08f9000000001ce5
  LAB_00BA:
  MOVE.w #$0067,D0  ;17fc: 303c0067
  BLibJsr #rawkeystatus
  BEQ.w LAB_00BB  ;1806: 67000018
    MOVE.w #$0065,D0  ;180a: 303c0065
    BLibJsr #rawkeystatus
    BEQ.w LAB_00BB  ;1814: 6700000a
      BSET #1,LAB_00F5+3  ;1818: 08f9000100001ce5
  LAB_00BB:
  TST.w D2   ;1820: 4a42
  BNE.w LAB_00BC  ;1822: 6600000c
    MOVE.w D2,LAB_00EA  ;1826: 33c200001cce
    BRA.w LAB_00CD  ;182c: 60000164
  LAB_00BC:
  CLR.w LAB_00EF+2  ;1830: 427900001cd8
  ;DC.w $b479   ;1836
  ;DC.l LAB_00EA  ;1838: 00001cce
  CMP.w LAB_00EA,D2
  BNE.w LAB_00BD  ;183c: 6600001a
    SUBI.w #$0001,LAB_00EA+2 ;1840: 0479000100001cd0
    BPL.w LAB_00CD  ;1848: 6a000148
      MOVE.w LAB_00ED+2(PC),LAB_00EA+2 ;184c: 33fa048600001cd0
      BRA.w LAB_00BE  ;1854: 60000014
  LAB_00BD:
    MOVE.w LAB_00ED+2(PC),D0 ;1858: 303a047a
    ADD.w D0,D0   ;185c: d040
    MOVE.w D0,LAB_00EA+2  ;185e: 33c000001cd0
    MOVE.w D2,LAB_00EA  ;1864: 33c200001cce
  LAB_00BE:
  TST.w LAB_00A9+2  ;186a: 4a79000016d0
  BNE.w LAB_00C4  ;1870: 66000074
  TST.w LAB_00ED  ;1874: 4a7900001cd2
  BNE.w LAB_00CD  ;187a: 66000116
  BTST #0,LAB_00EA+1  ;187e: 0839000000001ccf
  BEQ.w LAB_00BF  ;1886: 67000010
    MOVEA.l 22(A3),A0  ;188a: 206b0016
    CMPI.w #$0005,8(A0)  ;188e: 0c6800050008
    BEQ.w LAB_00C1  ;1894: 67000028
  LAB_00BF:
  ASL.w #2,D2   ;1898: e542
  MOVEM.w LAB_00C0(PC,D2.w),D0-D1 ;189a: 4cbb0003200c
  MOVEA.l (A7),A3   ;18a0: 2657
  BSR.w _selectbox1  ;18a2: 6100f9ca
  BRA.w LAB_00CD  ;18a6: 600000ea

  LAB_00C0: 
  ORI.b #$00,D0   ;18aa: 00000000
  Dc.w $0000   ;18ae
  Dc.w $ffff   ;18b0
  Dc.w $ffff   ;18b2
  ORI.b #$00,D0   ;18b4: 00000000
  ORI.b #$01,D1   ;18b8: 00010001
  Dc.w $0000   ;18bc

  LAB_00C1:
  MOVEM.w 12(A0),D0-D1  ;18be: 4ca80003000c
  ADD.w LAB_00EA(PC),D0  ;18c4: d07a0408
  SUBQ.w #2,D0   ;18c8: 5540
  BPL.w LAB_00C2  ;18ca: 6a000004
    MOVEQ #0,D0   ;18ce: 7000
  LAB_00C2:
  ;DC.w $b041   ;18d0
  CMP.w D1,D0
  BMI.w LAB_00C3  ;18d2: 6b000006
    MOVE.w D1,D0   ;18d6: 3001
    SUBQ.w #1,D0   ;18d8: 5340
  LAB_00C3:
  MOVE.w D0,12(A0)  ;18da: 3140000c
  BSR.w LAB_0041  ;18de: 6100f3ee
  BRA.w LAB_00DC  ;18e2: 6000025c
  
  LAB_00C4:
  MOVEA.l (A7),A3   ;18e6: 2657
  BSR.w LAB_00DE  ;18e8: 6100028c
  MOVE.w LAB_00AD+2,D0  ;18ec: 3039000016d8
  MOVEA.l 22(A3),A0  ;18f2: 206b0016
  MOVE.l 20(A0),D1  ;18f6: 22280014
  SUB.w 28(A0),D1  ;18fa: 9268001c
  SUBQ.w #1,D1   ;18fe: 5341
  CMPI.w #$0002,LAB_00EA  ;1900: 0c79000200001cce
  BNE.w LAB_00C5  ;1908: 6600000a
    SUBQ.w #1,D0   ;190c: 5340
    BPL.w LAB_00C5  ;190e: 6a000004
      MOVEQ #0,D0   ;1912: 7000
  LAB_00C5:
  CMPI.w #$0004,LAB_00EA  ;1914: 0c79000400001cce
  BNE.w LAB_00C6  ;191c: 6600000c
    ADDQ.w #1,D0   ;1920: 5240
    ;DC.w $b041   ;1922
    CMP.w D1,D0
    BMI.w LAB_00C6  ;1924: 6b000004
      SUBQ.w #1,D0   ;1928: 5340
  LAB_00C6:
  MOVE.w D0,LAB_00AD+2  ;192a: 33c0000016d8
  MOVEQ #1,D1   ;1930: 7201
  CMPI.w #$0001,LAB_00EA  ;1932: 0c79000100001cce
  BEQ.w LAB_00C7  ;193a: 67000010
    CMPI.w #$0003,LAB_00EA  ;193e: 0c79000300001cce
    BNE.w LAB_00CC  ;1946: 66000042
      MOVEQ #-1,D1   ;194a: 72ff
  LAB_00C7:
  MOVEA.l 24(A0),A1  ;194c: 22680018
  ADDA.w 28(A0),A1  ;1950: d2e8001c
  ADDA.w D0,A1   ;1954: d2c0
  ADD.b (A1),D1   ;1956: d211
  CMPI.b #$1f,D1   ;1958: 0c01001f
  BNE.w LAB_00C8  ;195c: 66000006
    MOVE.b #$5a,D1   ;1960: 123c005a
  LAB_00C8:
  CMPI.b #$21,D1   ;1964: 0c010021
  BNE.w LAB_00C9  ;1968: 66000006
    MOVE.b #$30,D1   ;196c: 123c0030
  LAB_00C9:
  CMPI.b #$30,D1   ;1970: 0c010030
  BMI.w LAB_00CA  ;1974: 6b00000a
    CMPI.b #$5b,D1   ;1978: 0c01005b
    BMI.w LAB_00CB  ;197c: 6b000006
  LAB_00CA:
    MOVE.b #$20,D1   ;1980: 123c0020
  LAB_00CB:
  MOVE.b D1,(A1)   ;1984: 1281
  BSR.w LAB_00DD  ;1986: 610001c0
  LAB_00CC:
  BSR.w LAB_00DE  ;198a: 610001ea
  BRA.w LAB_00DC  ;198e: 600001b0
  LAB_00CD:
  MOVE.w #$0044,D0  ;1992: 303c0044
  BLibJsr #rawkeystatus
  SNE D2   ;199c: 56c2
  EXT.w D2   ;199e: 4882
  OR.w LAB_00F3(PC),D2  ;19a0: 847a033c
  OR.w LAB_00F5+2(PC),D2 ;19a4: 847a033e
  BNE.w LAB_00D0  ;19a8: 6600006a
  TST.w LAB_00ED  ;19ac: 4a7900001cd2
  BEQ.w LAB_00D3  ;19b2: 670000d0
  CLR.w LAB_00ED  ;19b6: 427900001cd2
  TST.w LAB_00A9+2  ;19bc: 4a79000016d0
  BNE.w LAB_00D3  ;19c2: 660000c0
  CLR.w LAB_00A9  ;19c6: 4279000016ce
  CLR.w LAB_00AB  ;19cc: 4279000016d2
  MOVEA.l (A7),A3   ;19d2: 2657
  MOVE.l 22(A3),D0  ;19d4: 202b0016
  BEQ.w LAB_00D3  ;19d8: 670000aa
  MOVEA.l D0,A0   ;19dc: 2040
  TST.w 10(A0)   ;19de: 4a68000a
  BPL.w LAB_00D3  ;19e2: 6a0000a0
  NOT.w 10(A0)   ;19e6: 4668000a
  CMPI.w #$0001,8(A0)  ;19ea: 0c6800010008
  BNE.w LAB_00CF  ;19f0: 66000016
  MOVEM.w 12(A0),D0-D1  ;19f4: 4ca80003000c
  ADDQ.w #1,D0   ;19fa: 5240
  ;DC.w $b041   ;19fc
  CMP.w D1,D0
  BCS.w LAB_00CE  ;19fe: 65000004
    MOVEQ #0,D0   ;1a02: 7000
  LAB_00CE:
  MOVE.w D0,12(A0)  ;1a04: 3140000c
  LAB_00CF:
  BSR.w LAB_0041  ;1a08: 6100f2c4
  MOVEM.l (A7)+,A3-A4  ;1a0c: 4cdf1800
  MOVEQ #-1,D0   ;1a10: 70ff
  RTS    ;1a12: 4e75

  LAB_00D0:
  TST.w LAB_00A9  ;1a14: 4a79000016ce
  BNE.w LAB_00E0  ;1a1a: 660001c6
  TST.w LAB_00AB  ;1a1e: 4a79000016d2
  BNE.w LAB_00DF  ;1a24: 6600018a
  TST.w LAB_00ED  ;1a28: 4a7900001cd2
  BNE.w LAB_00D3  ;1a2e: 66000054
  MOVE.w D2,LAB_00ED  ;1a32: 33c200001cd2
  TST.w LAB_00A9+2  ;1a38: 4a79000016d0
  BEQ.w LAB_00D1  ;1a3e: 6700000c
    CLR.w LAB_00A9+2  ;1a42: 4279000016d0
    BRA.w LAB_00D3  ;1a48: 6000003a
  LAB_00D1:
  TST.w LAB_00EF+2  ;1a4c: 4a7900001cd8
  BEQ.w LAB_00D2  ;1a52: 67000014
  MOVEM.w LAB_00F3+2(PC),D1-D2 ;1a56: 4cba00060286
  MOVEA.l (A7),A3   ;1a5c: 2657
  BSR.w _selectbox2  ;1a5e: 6100f79e
  TST.w D0   ;1a62: 4a40
    BEQ.w LAB_00DC  ;1a64: 670000da
  LAB_00D2:
  MOVEA.l (A7),A3   ;1a68: 2657
  MOVE.l 22(A3),D0  ;1a6a: 202b0016
  BEQ.w LAB_00D3  ;1a6e: 67000014
    MOVEA.l D0,A0   ;1a72: 2040
    NOT.w 10(A0)   ;1a74: 4668000a
    BSR.w _activateselectedbox  ;1a78: 6100fbb2
    MOVEM.l (A7)+,A3-A4  ;1a7c: 4cdf1800
    MOVEQ #1,D0   ;1a80: 7001
    RTS    ;1a82: 4e75
  LAB_00D3:
  TST.w LAB_00A9+2  ;1a84: 4a79000016d0
  BEQ.w LAB_00DC  ;1a8a: 670000b4
  BLibJsr #blitzkeyslib LSL 7 + 6 ; BLitzKey
  TST.w D0   ;1a94: 4a40
  BMI.w LAB_00DC  ;1a96: 6b0000a8
  MOVEA.l (A7),A3   ;1a9a: 2657
  MOVE.w D0,-(A7)  ;1a9c: 3f00
  BSR.w LAB_00DE  ;1a9e: 610000d6
  MOVE.w (A7)+,D0  ;1aa2: 301f
  MOVEA.l 22(A3),A0  ;1aa4: 206b0016
  MOVEM.l 20(A0),D1/A1  ;1aa8: 4ce802020014
  ADDA.w 28(A0),A1  ;1aae: d2e8001c
  SUB.w 28(A0),D1  ;1ab2: 9268001c
  SUBQ.w #1,D1   ;1ab6: 5341
  MOVE.w LAB_00AD+2(PC),D2 ;1ab8: 343afc1e
  CMPI.w #$0020,D0  ;1abc: 0c400020
  BCS.w LAB_00D8  ;1ac0: 65000042
  CMPI.w #$007e,D0  ;1ac4: 0c40007e
  BHI.w LAB_00D8  ;1ac8: 6200003a
  CMPI.w #$0061,D0  ;1acc: 0c400061
  BCS.w LAB_00D4  ;1ad0: 65000006
  SUBI.w #$0020,D0  ;1ad4: 04400020
  LAB_00D4:
  MOVE.w D1,D3   ;1ad8: 3601
  LAB_00D5:
  SUBQ.w #1,D3   ;1ada: 5343
  ;DC.w $b443   ;1adc
  CMP.w D3,D2
  BEQ.w LAB_00D6  ;1ade: 6700000c
    MOVE.b -1(A1,D3.w),0(A1,D3.w) ;1ae2: 13b130ff3000
    BRA.w LAB_00D5  ;1ae8: 6000fff0
  LAB_00D6:
  MOVE.b D0,0(A1,D2.w)  ;1aec: 13802000
  ADDQ.w #1,D2   ;1af0: 5242
  ;DC.w $b441   ;1af2
  CMP.w D1,D2
  BMI.w LAB_00D7  ;1af4: 6b000004
    SUBQ.w #1,D2   ;1af8: 5342
  LAB_00D7:
  MOVE.w D2,LAB_00AD+2  ;1afa: 33c2000016d8
  BRA.w LAB_00DB  ;1b00: 60000036
  LAB_00D8:
  CMPI.w #$007f,D0  ;1b04: 0c40007f
  BEQ.w LAB_00D9  ;1b08: 67000016
    CMPI.w #$0008,D0  ;1b0c: 0c400008
    BNE.w LAB_00DC  ;1b10: 6600002e
      SUBQ.w #1,D2   ;1b14: 5342
      BMI.w LAB_00DC  ;1b16: 6b000028
        MOVE.w D2,LAB_00AD+2  ;1b1a: 33c2000016d8
  LAB_00D9:
  ADDQ.w #1,D2   ;1b20: 5242
  ;DC.w $b242   ;1b22
  CMP.w D2,D1
  BEQ.w LAB_00DA  ;1b24: 6700000c
    MOVE.b 0(A1,D2.w),-1(A1,D2.w) ;1b28: 13b1200020ff
    BRA.w LAB_00D9  ;1b2e: 6000fff0
  LAB_00DA:
  MOVE.b #$20,-1(A1,D2.w) ;1b32: 13bc002020ff
  LAB_00DB:
  BSR.w LAB_00DD  ;1b38: 6100000e
  BSR.w LAB_00DE  ;1b3c: 61000038
  LAB_00DC:
  MOVEM.l (A7)+,A3-A4  ;1b40: 4cdf1800
  MOVEQ #0,D0   ;1b44: 7000
  RTS    ;1b46: 4e75

LAB_00DD:
  MOVEA.l 8(A3),A4  ;1b48: 286b0008
  MOVE.l A0,-(A7)  ;1b4c: 2f08
  MOVE.l 40(A4),-(A7)  ;1b4e: 2f2c0028
  MOVE.w 28(A0),D3  ;1b52: 3628001c
  MOVE.l LAB_00AB+2(PC),40(A4) ;1b56: 297afb7c0028
  MOVEM.l 20(A0),D0/A0  ;1b5c: 4ce801010014
  ADDA.w D3,A0   ;1b62: d0c3
  SUB.w D3,D0   ;1b64: 9043
  SUBQ.w #1,D0   ;1b66: 5340
  BLibJsr #fontlib LSL 7 + $e ; ???
  MOVE.l (A7)+,40(A4)  ;1b6e: 295f0028
  MOVEA.l (A7)+,A0  ;1b72: 205f
RTS    ;1b74: 4e75

LAB_00DE:
  MOVEA.l 8(A3),A4  ;1b76: 286b0008
  MOVE.w (A4),D3   ;1b7a: 3614
  MOVEA.l 8(A4),A4  ;1b7c: 286c0008
  MOVEM.w LAB_00AB+2(PC),D0-D2 ;1b80: 4cba0007fb50
  LSR.w #3,D0   ;1b86: e648
  ;DC.w $c2c3   ;1b88
  MULU.w  D3,D1
  ADDA.w D0,A4   ;1b8a: d8c0
  ADDA.l D1,A4   ;1b8c: d9c1
  ADDA.w D2,A4   ;1b8e: d8c2
  NOT.b (A4)   ;1b90: 4614
  ADDA.w D3,A4   ;1b92: d8c3
  NOT.b (A4)   ;1b94: 4614
  ADDA.w D3,A4   ;1b96: d8c3
  NOT.b (A4)   ;1b98: 4614
  ADDA.w D3,A4   ;1b9a: d8c3
  NOT.b (A4)   ;1b9c: 4614
  ADDA.w D3,A4   ;1b9e: d8c3
  NOT.b (A4)   ;1ba0: 4614
  ADDA.w D3,A4   ;1ba2: d8c3
  NOT.b (A4)   ;1ba4: 4614
  ADDA.w D3,A4   ;1ba6: d8c3
  NOT.b (A4)   ;1ba8: 4614
  ADDA.w D3,A4   ;1baa: d8c3
  NOT.b (A4)   ;1bac: 4614
RTS    ;1bae: 4e75

LAB_00DF:
  MOVEA.l (A7),A3   ;1bb0: 2657
  MOVEA.l 22(A3),A0  ;1bb2: 206b0016
  MOVEM.w LAB_00F8(PC),D0-D1 ;1bb6: 4cba0003012c
  MOVEM.w LAB_00F3+2(PC),D2-D3 ;1bbc: 4cba000c0120
  SUB.w D0,D2   ;1bc2: 9440
  SUB.w D1,D3   ;1bc4: 9641
  MOVEM.w D2-D3,12(A0)  ;1bc6: 48a8000c000c
  MOVEM.w D0-D1,LAB_00F3+2 ;1bcc: 48b9000300001ce0
  BLibJsr #mouselib LSL 7 + 8 ; PositionMouse
  MOVEM.l (A7)+,A3-A4  ;1bda: 4cdf1800
  MOVEQ #2,D0   ;1bde: 7002
RTS    ;1be0: 4e75

LAB_00E0:
 MOVEA.l (A7),A3   ;1be2: 2657
 MOVEA.l 22(A3),A0  ;1be4: 206b0016
 MOVEM.w 12(A0),D0-D1  ;1be8: 4ca80003000c
 TST.w LAB_00EF+2  ;1bee: 4a7900001cd8
 BEQ.w LAB_00E5  ;1bf4: 6700006e
 MOVEM.w 4(A0),D2-D3  ;1bf8: 4ca8000c0004
 MOVEM.w 28(A0),D4-D5  ;1bfe: 4ca80030001c
 TST.w D0   ;1c04: 4a40
 BMI.w LAB_00E2  ;1c06: 6b00002a
 MOVE.w LAB_00F3+2(PC),D0 ;1c0a: 303a00d4
 SUBQ.w #4,D2   ;1c0e: 5942
 SUB.w D4,D2   ;1c10: 9444
 SUB.w 0(A0),D0  ;1c12: 90680000
 SUBQ.w #2,D0   ;1c16: 5540
 LSR.w #1,D4   ;1c18: e24c
 SUB.w D4,D0   ;1c1a: 9044
 BPL.w LAB_00E1  ;1c1c: 6a000004
 MOVEQ #0,D0   ;1c20: 7000
LAB_00E1:
 LSR.w #1,D0   ;1c22: e248
 EXT.l D0   ;1c24: 48c0
 SWAP D0   ;1c26: 4840
 DIVS D2,D0   ;1c28: 81c2
 BVC.w LAB_00E2  ;1c2a: 68000006
 MOVE.w #$7fff,D0  ;1c2e: 303c7fff
LAB_00E2:
 TST.w D1   ;1c32: 4a41
 BMI.w LAB_00E4  ;1c34: 6b00002a
 MOVE.w LAB_00F5(PC),D1  ;1c38: 323a00a8
 SUBQ.w #2,D3   ;1c3c: 5543
 SUB.w D5,D3   ;1c3e: 9645
 SUB.w 2(A0),D1  ;1c40: 92680002
 SUBQ.w #2,D1   ;1c44: 5541
 LSR.w #1,D5   ;1c46: e24d
 SUB.w D5,D1   ;1c48: 9245
 BPL.w LAB_00E3  ;1c4a: 6a000004
 MOVEQ #0,D1   ;1c4e: 7200
LAB_00E3:
 LSR.w #1,D1   ;1c50: e249
 EXT.l D1   ;1c52: 48c1
 SWAP D1   ;1c54: 4841
 DIVS D3,D1   ;1c56: 83c3
 BVC.w LAB_00E4  ;1c58: 68000006
 MOVE.w #$7fff,D1  ;1c5c: 323c7fff
LAB_00E4:
 BRA.w LAB_00E9  ;1c60: 6000005a
LAB_00E5:
 MOVE.w LAB_00EA(PC),D2  ;1c64: 343a0068
 MOVE.w LAB_00EF(PC),D3  ;1c68: 363a006c
 TST.w D0   ;1c6c: 4a40
 BMI.w LAB_00E7  ;1c6e: 6b000024
 CMPI.w #$0002,D2  ;1c72: 0c420002
 BNE.w LAB_00E6  ;1c76: 6600000a
 SUB.w D3,D0   ;1c7a: 9043
 BPL.w LAB_00E6  ;1c7c: 6a000004
 MOVEQ #0,D0   ;1c80: 7000
LAB_00E6:
 CMPI.w #$0004,D2  ;1c82: 0c420004
 BNE.w LAB_00E7  ;1c86: 6600000c
 ADD.w D3,D0   ;1c8a: d043
 BPL.w LAB_00E7  ;1c8c: 6a000006
 MOVE.w #$7fff,D0  ;1c90: 303c7fff
LAB_00E7:
 TST.w D1   ;1c94: 4a41
 BMI.w LAB_00E9  ;1c96: 6b000024
 CMPI.w #$0001,D2  ;1c9a: 0c420001
 BNE.w LAB_00E8  ;1c9e: 6600000a
 SUB.w D3,D1   ;1ca2: 9243
 BPL.w LAB_00E8  ;1ca4: 6a000004
 MOVEQ #0,D1   ;1ca8: 7200
LAB_00E8:
 CMPI.w #$0003,D2  ;1caa: 0c420003
 BNE.w LAB_00E9  ;1cae: 6600000c
 ADD.w D3,D1   ;1cb2: d243
 BPL.w LAB_00E9  ;1cb4: 6a000006
 MOVE.w #$7fff,D1  ;1cb8: 323c7fff
LAB_00E9:
  MOVEM.w D0-D1,12(A0)  ;1cbc: 48a80003000c
  BSR.w LAB_0041  ;1cc2: 6100f00a
  MOVEM.l (A7)+,A3-A4  ;1cc6: 4cdf1800
  MOVEQ #2,D0   ;1cca: 7002
RTS    ;1ccc: 4e75

LAB_00EA: Dc.l $00000000
LAB_00ED: Dc.l $00000006
LAB_00EF: Dc.l $04000000
LAB_00F1: Dc.l $00000000
LAB_00F3: Dc.l $00000000
LAB_00F5: Dc.l $00000000
LAB_00F8: Dc.l $00000000

error_uninitpage:
  MOVE.l #LAB_00FA,D0
  TRAP #0
LAB_00FA: Dc.b "UnInitialised Page",0,0

error_illegalboxnumber:
  MOVE.l #LAB_00FC,D0 
  TRAP #0
LAB_00FC: Dc.b "Illegal Box# For Page",0

error_valueoutofrange:
  MOVE.l #LAB_00FE,D0
  TRAP #0
LAB_00FE: Dc.b "Value Out of Range",0,0

error_noroom:
  MOVE.l #LAB_0100,D0
  TRAP #0
LAB_0100: Dc.b "No Room For String",0,0

error_illegalboxtype:
  MOVE.l #LAB_0102,D0
  TRAP #0
LAB_0102: Dc.b "Illegal Box Type",0,0

error_uninitbank:
  MOVE.l #LAB_0104,D0
  TRAP #0
LAB_0104: Dc.b "Unitialised Bank",0,0

error_nopropbox:
  MOVE.l #LAB_0106,D0
  TRAP #0
LAB_0106: Dc.b "Not a Prop Box",0,0

error_uninitbitmap:
  MOVE.l #LAB_0108,D0
  TRAP #0
LAB_0108: Dc.b "Unitialised BitMap",0,0
